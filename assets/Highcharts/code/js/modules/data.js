(function(a){"object"===typeof module&&module.exports?module.exports=a:a(Highcharts)})(function(a){(function(f){var b=f.win.document,e=f.each,h=f.pick,j=f.inArray,i=f.isNumber,c=f.splat,d,k=function(g,l){this.init(g,l)};f.extend(k.prototype,{init:function(g,l){this.options=g;this.chartOptions=l;this.columns=g.columns||this.rowsToColumns(g.rows)||[];this.firstRowAsNames=h(g.firstRowAsNames,!0);this.decimalRegex=g.decimalPoint&&new RegExp("^(-?[0-9]+)"+g.decimalPoint+"([0-9]+)$");this.rawColumns=[];this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var q=this.chartOptions,r=this.options,o=[],m=function(t){return(f.seriesTypes[t||"line"].prototype.pointArrayMap||[0]).length},n=q&&q.chart&&q.chart.type,p=[],g=[],s=0,l;e(q&&q.series||[],function(t){p.push(m(t.type||n))});e(r&&r.seriesMapping||[],function(t){o.push(t.x||0)});0===o.length&&o.push(0);e(r&&r.seriesMapping||[],function(t){var y=new d,w,u=p[s]||m(n),x=f.seriesTypes[((q&&q.series||[])[s]||{}).type||n||"line"].prototype.pointArrayMap||["y"];y.addColumnReader(t.x,"x");for(w in t){t.hasOwnProperty(w)&&"x"!==w&&y.addColumnReader(t[w],w)}for(l=0;l<u;l++){y.hasReader(x[l])||y.addColumnReader(void 0,x[l])}g.push(y);s++});r=f.seriesTypes[n||"line"].prototype.pointArrayMap;void 0===r&&(r=["y"]);this.valueCount={global:m(n),xColumns:o,individual:p,seriesBuilders:g,globalPointArrayMap:r}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns));this.getColumnDistribution();this.parseTypes();!1!==this.parsed()&&this.complete()},parseCSV:function(){var u=this,v=this.options,q=v.csv,o=this.columns,p=v.startRow||0,r=v.endRow||Number.MAX_VALUE,l=v.startColumn||0,w=v.endColumn||Number.MAX_VALUE,m,n,s=0;q&&(n=q.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(v.lineDelimiter||"\n"),m=v.itemDelimiter||(-1!==q.indexOf("\t")?"\t":","),e(n,function(t,z){var y=u.trim(t),x=0===y.indexOf("#");z>=p&&z<=r&&!x&&""!==y&&(t=t.split(m),e(t,function(g,A){A>=l&&A<=w&&(o[A-l]||(o[A-l]=[]),o[A-l][s]=g)}),s+=1)}),this.dataFound())},parseTable:function(){var g=this.options,l=g.table,p=this.columns,n=g.startRow||0,o=g.endRow||Number.MAX_VALUE,q=g.startColumn||0,m=g.endColumn||Number.MAX_VALUE;l&&("string"===typeof l&&(l=b.getElementById(l)),e(l.getElementsByTagName("tr"),function(r,s){s>=n&&s<=o&&e(r.children,function(t,u){("TD"===t.tagName||"TH"===t.tagName)&&u>=q&&u<=m&&(p[u-q]||(p[u-q]=[]),p[u-q][s-n]=t.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var s=this,t=this.options,q=t.googleSpreadsheetKey,o=this.columns,p=t.startRow||0,r=t.endRow||Number.MAX_VALUE,l=t.startColumn||0,n=t.endColumn||Number.MAX_VALUE,m,u;q&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+q+"/"+(t.googleSpreadsheetWorksheet||"od6")+"/public/values?alt\x3djson-in-script\x26callback\x3d?",error:t.error,success:function(v){v=v.feed.entry;var y,w=v.length,x=0,z=0,g;for(g=0;g<w;g++){y=v[g],x=Math.max(x,y.gs$cell.col),z=Math.max(z,y.gs$cell.row)}for(g=0;g<x;g++){g>=l&&g<=n&&(o[g-l]=[],o[g-l].length=Math.min(z,r-p))}for(g=0;g<w;g++){y=v[g],m=y.gs$cell.row-1,u=y.gs$cell.col-1,u>=l&&u<=n&&m>=p&&m<=r&&(o[u-l][m-p]=y.content.$t)}e(o,function(A){for(g=0;g<A.length;g++){void 0===A[g]&&(A[g]=null)}});s.dataFound()}})},trim:function(g,l){"string"===typeof g&&(g=g.replace(/^\s+|\s+$/g,""),l&&/^[0-9\s]+$/.test(g)&&(g=g.replace(/\s/g,"")),this.decimalRegex&&(g=g.replace(this.decimalRegex,"$1.$2")));return g},parseTypes:function(){for(var g=this.columns,l=g.length;l--;){this.parseColumn(g[l],l)}},parseColumn:function(D,E){var B=this.rawColumns,z=this.columns,A=D.length,C,w,y,x,t=this.firstRowAsNames,v=-1!==j(E,this.valueCount.xColumns),l=[],s=this.chartOptions,o,F=(this.options.columnTypes||[])[E],s=v&&(s&&s.xAxis&&"category"===c(s.xAxis)[0].type||"string"===F);for(B[E]||(B[E]=[]);A--;){C=l[A]||D[A],y=this.trim(C),x=this.trim(C,!0),w=parseFloat(x),void 0===B[E][A]&&(B[E][A]=y),s||0===A&&t?D[A]=y:+x===w?(D[A]=w,31536000000<w&&"float"!==F?D.isDatetime=!0:D.isNumeric=!0,void 0!==D[A+1]&&(o=w>D[A+1])):(w=this.parseDate(C),v&&i(w)&&"float"!==F?(l[A]=C,D[A]=w,D.isDatetime=!0,void 0!==D[A+1]&&(C=w>D[A+1],C!==o&&void 0!==o&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,A=D.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):D.unsorted=!0),o=C)):(D[A]=""===y?null:y,0!==A&&(D.isDatetime||D.isNumeric)&&(D.mixed=!0)))}v&&D.mixed&&(z[E]=B[E]);if(v&&o&&this.options.sort){for(E=0;E<z.length;E++){z[E].reverse(),t&&z[E].unshift(z[E].pop())}}},dateFormats:{"YYYY-mm-dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{2})[\-\/\.]([0-9]{2})$/,parser:function(g){return Date.UTC(+g[1],g[2]-1,+g[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(g){return Date.UTC(+g[3],g[2]-1,+g[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(g){return Date.UTC(+g[3],g[1]-1,+g[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(g){return Date.UTC(+g[3]+2000,g[2]-1,+g[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(g){return Date.UTC(+g[3]+2000,g[1]-1,+g[2])}}},parseDate:function(g){var l=this.options.parseDate,o,m,n=this.options.dateFormat||this.dateFormat,p;if(l){o=l(g)}else{if("string"===typeof g){if(n){l=this.dateFormats[n],(p=g.match(l.regex))&&(o=l.parser(p))}else{for(m in this.dateFormats){if(l=this.dateFormats[m],p=g.match(l.regex)){this.dateFormat=m;this.alternativeFormat=l.alternative;o=l.parser(p);break}}}p||(p=Date.parse(g),"object"===typeof p&&null!==p&&p.getTime?o=p.getTime()-60000*p.getTimezoneOffset():i(p)&&(o=p-60000*(new Date(p)).getTimezoneOffset()))}}return o},rowsToColumns:function(g){var l,o,m,n,p;if(g){for(p=[],o=g.length,l=0;l<o;l++){for(n=g[l].length,m=0;m<n;m++){p[m]||(p[m]=[]),p[m][l]=g[l][m]}}}return p},parsed:function(){if(this.options.parsed){return this.options.parsed.call(this,this.columns)}},getFreeIndexes:function(g,l){var o,m=[],n=[],p;for(o=0;o<g;o+=1){m.push(!0)}for(g=0;g<l.length;g+=1){for(p=l[g].getReferencedColumnIndexes(),o=0;o<p.length;o+=1){m[p[o]]=!1}}for(o=0;o<m.length;o+=1){m[o]&&n.push(o)}return n},complete:function(){var s=this.columns,t,q=this.options,o,p,r,l,n=[],m;if(q.complete||q.afterComplete){for(r=0;r<s.length;r++){this.firstRowAsNames&&(s[r].name=s[r].shift())}o=[];p=this.getFreeIndexes(s.length,this.valueCount.seriesBuilders);for(r=0;r<this.valueCount.seriesBuilders.length;r++){m=this.valueCount.seriesBuilders[r],m.populateColumns(p)&&n.push(m)}for(;0<p.length;){m=new d;m.addColumnReader(0,"x");r=j(0,p);-1!==r&&p.splice(r,1);for(r=0;r<this.valueCount.global;r++){m.addColumnReader(void 0,this.valueCount.globalPointArrayMap[r])}m.populateColumns(p)&&n.push(m)}0<n.length&&0<n[0].readers.length&&(m=s[n[0].readers[0].columnIndex],void 0!==m&&(m.isDatetime?t="datetime":m.isNumeric||(t="category")));if("category"===t){for(r=0;r<n.length;r++){for(m=n[r],p=0;p<m.readers.length;p++){"x"===m.readers[p].configName&&(m.readers[p].configName="name")}}}for(r=0;r<n.length;r++){m=n[r];p=[];for(l=0;l<s[0].length;l++){p[l]=m.read(s,l)}o[r]={data:p};m.name&&(o[r].name=m.name);"category"===t&&(o[r].turboThreshold=0)}s={series:o};t&&(s.xAxis={type:t},"category"===t&&(s.xAxis.uniqueNames=!1));q.complete&&q.complete(s);q.afterComplete&&q.afterComplete(s)}}});f.Data=k;f.data=function(g,l){return new k(g,l)};f.wrap(f.Chart.prototype,"init",function(g,l,n){var m=this;l&&l.data?f.data(f.extend(l.data,{afterComplete:function(p){var q,o;if(l.hasOwnProperty("series")){if("object"===typeof l.series){for(q=Math.max(l.series.length,p.series.length);q--;){o=l.series[q]||{},l.series[q]=f.merge(o,p.series[q])}}else{delete l.series}}l=f.merge(p,l);g.call(m,l,n)}}),l):g.call(m,l,n)});d=function(){this.readers=[];this.pointIsArray=!0};d.prototype.populateColumns=function(g){var l=!0;e(this.readers,function(m){void 0===m.columnIndex&&(m.columnIndex=g.shift())});e(this.readers,function(m){void 0===m.columnIndex&&(l=!1)});return l};d.prototype.read=function(g,l){var o=this.pointIsArray,m=o?[]:{},n;e(this.readers,function(q){var p=g[q.columnIndex][l];o?m.push(p):m[q.configName]=p});void 0===this.name&&2<=this.readers.length&&(n=this.getReferencedColumnIndexes(),2<=n.length&&(n.shift(),n.sort(),this.name=g[n.shift()].name));return m};d.prototype.addColumnReader=function(g,l){this.readers.push({columnIndex:g,configName:l});"x"!==l&&"y"!==l&&void 0!==l&&(this.pointIsArray=!1)};d.prototype.getReferencedColumnIndexes=function(){var g,l=[],m;for(g=0;g<this.readers.length;g+=1){m=this.readers[g],void 0!==m.columnIndex&&l.push(m.columnIndex)}return l};d.prototype.hasReader=function(g){var l,m;for(l=0;l<this.readers.length;l+=1){if(m=this.readers[l],m.configName===g){return !0}}}})(a)});