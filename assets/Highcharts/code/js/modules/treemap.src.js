(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(o){var g=o.seriesType,f=o.seriesTypes,b=o.map,m=o.merge,j=o.extend,r=o.noop,n=o.each,p=o.grep,q=o.isNumber,h=o.pick,l=o.Series,d=o.stableSort,e=o.Color,i=function(v,u,t){var s;t=t||this;for(s in v){if(v.hasOwnProperty(s)){u.call(t,v[s],s,v)}}},k=function(s,v,u,t){t=t||this;s=s||[];n(s,function(x,w){u=v.call(t,u,x,w,s)});return u},c=function(v,u,s){var t;s=s||this;t=u.call(s,v);if(t!==false){c(t,u,s)}};g("treemap","scatter",{showInLegend:false,marker:false,dataLabels:{enabled:true,defer:false,verticalAlign:"middle",formatter:function(){return this.point.name||this.point.id},inside:true},tooltip:{headerFormat:"",pointFormat:"<b>{point.name}</b>: {point.value}</b><br/>"},layoutAlgorithm:"sliceAndDice",layoutStartingDirection:"vertical",alternateStartingDirection:false,levelIsConstant:true,drillUpButton:{position:{align:"right",x:-10,y:10}},},{pointArrayMap:["value"],axisTypes:f.heatmap?["xAxis","yAxis","colorAxis"]:["xAxis","yAxis"],optionalAxis:"colorAxis",getSymbol:r,parallelArrays:["x","y","value","colorValue"],colorKey:"colorValue",translateColors:f.heatmap&&f.heatmap.prototype.translateColors,trackerGroups:["group","dataLabelsGroup"],getListOfParents:function(u,t){var s=k(u,function(x,y,v){var w=h(y.parent,"");if(x[w]===undefined){x[w]=[]}x[w].push(v);return x},{});i(s,function(v,w,x){if((w!=="")&&(o.inArray(w,t)===-1)){n(v,function(y){x[""].push(y)});delete x[w]}});return s},getTree:function(){var s,u=this,v=b(this.data,function(w){return w.id}),t=u.getListOfParents(this.data,v);u.nodeMap=[];s=u.buildNode("",-1,0,t,null);c(this.nodeMap[this.rootNode],function(x){var w=false,y=x.parent;x.visible=true;if(y||y===""){w=u.nodeMap[y]}return w});c(this.nodeMap[this.rootNode].children,function(w){var x=false;n(w,function(y){y.visible=true;if(y.children.length){x=(x||[]).concat(y.children)}});return x});this.setTreeValues(s);return s},init:function(u,s){var t=this;l.prototype.init.call(t,u,s);if(t.options.allowDrillToNode){t.drillTo()}},buildNode:function(t,x,s,z,A){var y=this,v=[],B=y.points[x],w,u;n((z[t]||[]),function(C){u=y.buildNode(y.points[C].id,C,(s+1),z,t);v.push(u)});w={id:t,i:x,children:v,level:s,parent:A,visible:false};y.nodeMap[w.id]=w;if(B){B.node=w}return w},setTreeValues:function(t){var x=this,u=x.options,w=0,v=[],y,s=x.points[t.i];n(t.children,function(z){z=x.setTreeValues(z);v.push(z);if(!z.ignore){w+=z.val}else{c(z.children,function(A){var B=false;n(A,function(C){j(C,{ignore:true,isLeaf:false,visible:false});if(C.children.length){B=(B||[]).concat(C.children)}});return B})}});d(v,function(A,z){return A.sortIndex-z.sortIndex});y=h(s&&s.options.value,w);if(s){s.value=y}j(t,{children:v,childrenTotal:w,ignore:!(h(s&&s.visible,true)&&(y>0)),isLeaf:t.visible&&!w,levelDynamic:(u.levelIsConstant?t.level:(t.level-x.nodeMap[x.rootNode].level)),name:h(s&&s.name,""),sortIndex:h(s&&s.sortIndex,-y),val:y});return t},calculateChildrenAreas:function(y,t){var w=this,A=w.options,s=this.levelMap[y.levelDynamic+1],x=h((w[s&&s.layoutAlgorithm]&&s.layoutAlgorithm),A.layoutAlgorithm),v=A.alternateStartingDirection,z=[],u;u=p(y.children,function(B){return !B.ignore});if(s&&s.layoutStartingDirection){t.direction=s.layoutStartingDirection==="vertical"?0:1}z=w[x](t,u);n(u,function(D,C){var B=z[C];D.values=m(B,{val:D.childrenTotal,direction:(v?1-t.direction:t.direction)});D.pointValues=m(B,{x:(B.x/w.axisRatio),width:(B.width/w.axisRatio)});if(D.children.length){w.calculateChildrenAreas(D,D.values)}})},setPointValues:function(){var t=this,u=t.xAxis,s=t.yAxis;n(t.points,function(v){var C=v.node,x=C.pointValues,y,w,B,z,A=0.5;if(x&&C.visible){y=Math.round(u.translate(x.x,0,0,0,1))-A;w=Math.round(u.translate(x.x+x.width,0,0,0,1))-A;B=Math.round(s.translate(x.y,0,0,0,1))-A;z=Math.round(s.translate(x.y+x.height,0,0,0,1))-A;v.shapeType="rect";v.shapeArgs={x:Math.min(y,w),y:Math.min(B,z),width:Math.abs(w-y),height:Math.abs(z-B)};v.plotX=v.shapeArgs.x+(v.shapeArgs.width/2);v.plotY=v.shapeArgs.y+(v.shapeArgs.height/2)}else{delete v.plotX;delete v.plotY}})},setColorRecursive:function(v,t,x){var u=this,s,w;if(v){s=u.points[v.i];w=u.levelMap[v.levelDynamic];t=h(s&&s.options.color,w&&w.color,t);x=h(s&&s.options.colorIndex,w&&w.colorIndex,x);if(s){s.color=t;s.colorIndex=x}if(v.children.length){n(v.children,function(y){u.setColorRecursive(y,t,x)})}}},algorithmGroup:function(t,s,v,u){this.height=t;this.width=s;this.plot=u;this.direction=v;this.startDirection=v;this.total=0;this.nW=0;this.lW=0;this.nH=0;this.lH=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(x,y){return Math.max((x/y),(y/x))}};this.addElement=function(w){this.lP.total=this.elArr[this.elArr.length-1];this.total=this.total+w;if(this.direction===0){this.lW=this.nW;this.lP.lH=this.lP.total/this.lW;this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH);this.nW=this.total/this.height;this.lP.nH=this.lP.total/this.nW;this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)}else{this.lH=this.nH;this.lP.lW=this.lP.total/this.lH;this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH);this.nH=this.total/this.width;this.lP.nW=this.lP.total/this.nH;this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH)}this.elArr.push(w)};this.reset=function(){this.nW=0;this.lW=0;this.elArr=[];this.total=0}},algorithmCalcPoints:function(u,E,D,v){var x,w,y,F,A=D.lW,t=D.lH,C=D.plot,s,B=0,z=D.elArr.length-1;if(E){A=D.nW;t=D.nH}else{s=D.elArr[D.elArr.length-1]}n(D.elArr,function(G){if(E||(B<z)){if(D.direction===0){x=C.x;w=C.y;y=A;F=G/y}else{x=C.x;w=C.y;F=t;y=G/F}v.push({x:x,y:w,width:y,height:F});if(D.direction===0){C.y=C.y+F}else{C.x=C.x+y}}B=B+1});D.reset();if(D.direction===0){D.width=D.width-A}else{D.height=D.height-t}C.y=C.parent.y+(C.parent.height-D.height);C.x=C.parent.x+(C.parent.width-D.width);if(u){D.direction=1-D.direction}if(!E){D.addElement(s)}},algorithmLowAspectRatio:function(s,B,u){var t=[],y=this,w,z={x:B.x,y:B.y,parent:B},A=B.direction,x=0,v=u.length-1,C=new this.algorithmGroup(B.height,B.width,A,z);n(u,function(D){w=(B.width*B.height)*(D.val/B.val);C.addElement(w);if(C.lP.nR>C.lP.lR){y.algorithmCalcPoints(s,false,C,t,z)}if(x===v){y.algorithmCalcPoints(s,true,C,t,z)}x=x+1});return t},algorithmFill:function(s,F,w){var v=[],B,D=F.direction,E=F.x,C=F.y,t=F.width,H=F.height,z,u,A,G;n(w,function(x){B=(F.width*F.height)*(x.val/F.val);z=E;u=C;if(D===0){G=H;A=B/G;t=t-A;E=E+A}else{A=t;G=B/A;H=H-G;C=C+G}v.push({x:z,y:u,width:A,height:G});if(s){D=1-D}});return v},strip:function(t,s){return this.algorithmLowAspectRatio(false,t,s)},squarified:function(t,s){return this.algorithmLowAspectRatio(true,t,s)},sliceAndDice:function(t,s){return this.algorithmFill(true,t,s)},stripes:function(t,s){return this.algorithmFill(false,t,s)},translate:function(){var u,t,s,v;l.prototype.translate.call(this);this.rootNode=h(this.options.rootId,"");this.levelMap=k(this.options.levels,function(w,x){w[x.level]=x;return w},{});s=this.tree=this.getTree();this.axisRatio=(this.xAxis.len/this.yAxis.len);this.nodeMap[""].pointValues=u={x:0,y:0,width:100,height:100};this.nodeMap[""].values=t=m(u,{width:(u.width*this.axisRatio),direction:(this.options.layoutStartingDirection==="vertical"?0:1),val:s.val});this.calculateChildrenAreas(s,t);if(this.colorAxis){this.translateColors()}else{if(!this.options.colorByPoint){this.setColorRecursive(this.tree)}}if(this.options.allowDrillToNode){v=this.nodeMap[this.rootNode].pointValues;this.xAxis.setExtremes(v.x,v.x+v.width,false);this.yAxis.setExtremes(v.y,v.y+v.height,false);this.xAxis.setScale();this.yAxis.setScale()}this.setPointValues()},drawDataLabels:function(){var t=this,u=p(t.points,function(w){return w.node.visible}),s,v;n(u,function(w){v=t.levelMap[w.node.levelDynamic];s={style:{}};if(!w.node.isLeaf){s.enabled=false}if(v&&v.dataLabels){s=m(s,v.dataLabels);t._hasPointLabels=true}if(w.shapeArgs){s.style.width=w.shapeArgs.width;if(w.dataLabel){w.dataLabel.css({width:w.shapeArgs.width+"px"})}}w.dlOptions=m(s,w.options.dataLabels)});l.prototype.drawDataLabels.call(this)},alignDataLabel:function(s){f.column.prototype.alignDataLabel.apply(this,arguments);if(s.dataLabel){s.dataLabel.attr({zIndex:s.node.zIndex+1})}},drawPoints:function(){var s=this,t=p(s.points,function(u){return u.node.visible});n(t,function(u){var v="levelGroup-"+u.node.levelDynamic;if(!s[v]){s[v]=s.chart.renderer.g(v).attr({zIndex:1000-u.node.levelDynamic}).add(s.group)}u.group=s[v]});f.column.prototype.drawPoints.call(this);if(s.options.allowDrillToNode){n(t,function(u){if(u.graphic){u.drillId=s.options.interactByLeaf?s.drillToByLeaf(u):s.drillToByGroup(u)}})}},drillTo:function(){var s=this;o.addEvent(s,"click",function(w){var t=w.point,u=t.drillId,v;if(u){v=s.nodeMap[s.rootNode].name||s.rootNode;t.setState("");s.drillToNode(u);s.showDrillUpButton(v)}})},drillToByGroup:function(s){var u=this,t=false;if((s.node.level-u.nodeMap[u.rootNode].level)===1&&!s.node.isLeaf){t=s.id}return t},drillToByLeaf:function(s){var v=this,u=false,t;if((s.node.parent!==v.rootNode)&&(s.node.isLeaf)){t=s.node;while(!u){t=v.nodeMap[t.parent];if(t.parent===v.rootNode){u=t.id}}}return u},drillUp:function(){var t=null,u,s;if(this.rootNode){u=this.nodeMap[this.rootNode];if(u.parent!==null){t=this.nodeMap[u.parent]}else{t=this.nodeMap[""]}}if(t!==null){this.drillToNode(t.id);if(t.id===""){this.drillUpButton=this.drillUpButton.destroy()}else{s=this.nodeMap[t.parent];this.showDrillUpButton((s.name||s.id))}}},drillToNode:function(s){this.options.rootId=s;this.isDirty=true;this.chart.redraw()},showDrillUpButton:function(u){var v=this,w=(u||"< Back"),x=v.options.drillUpButton,s,t;if(x.text){w=x.text}if(!this.drillUpButton){s=x.theme;t=s&&s.states;this.drillUpButton=this.chart.renderer.button(w,null,null,function(){v.drillUp()},s,t&&t.hover,t&&t.select).attr({align:x.position.align,zIndex:7}).add().align(x.position,false,x.relativeTo||"plotBox")}else{this.drillUpButton.attr({text:w}).align()}},buildKDTree:r,drawLegendSymbol:o.LegendSymbolMixin.drawRectangle,getExtremes:function(){l.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;l.prototype.getExtremes.call(this)},getExtremesFromAll:true,bindAxes:function(){var s={endOnTick:false,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:false,title:null,tickPositions:[]};l.prototype.bindAxes.call(this);o.extend(this.yAxis.options,s);o.extend(this.xAxis.options,s)}},{getClassName:function(){var u=o.Point.prototype.getClassName.call(this),t=this.series,s=t.options;if(this.node.level<=t.nodeMap[t.rootNode].level){u+=" highcharts-above-level"}else{if(!this.node.isLeaf&&!h(s.interactByLeaf,!s.allowDrillToNode)){u+=" highcharts-internal-node-interactive"}else{if(!this.node.isLeaf){u+=" highcharts-internal-node"}}}return u},isValid:function(){return q(this.value)},setState:function(s){o.Point.prototype.setState.call(this,s);this.graphic.attr({zIndex:s==="hover"?1:0})},setVisible:f.pie.prototype.pointClass.prototype.setVisible})}(a))}));