(function(a){"object"===typeof module&&module.exports?module.exports=a:a(Highcharts)})(function(a){(function(i){var d=i.seriesType,v=i.seriesTypes,b=i.map,o=i.merge,j=i.extend,e=i.noop,f=i.each,l=i.grep,C=i.isNumber,h=i.pick,r=i.Series,s=i.stableSort,q=function(k,g,p){var m;p=p||this;for(m in k){k.hasOwnProperty(m)&&g.call(p,k[m],m,k)}},c=function(k,g,p,m){m=m||this;k=k||[];f(k,function(u,t){p=g.call(m,p,u,t,k)});return p},n=function(k,g,m){m=m||this;k=g.call(m,k);!1!==k&&n(k,g,m)};d("treemap","scatter",{showInLegend:!1,marker:!1,dataLabels:{enabled:!0,defer:!1,verticalAlign:"middle",formatter:function(){return this.point.name||this.point.id},inside:!0},tooltip:{headerFormat:"",pointFormat:"\x3cb\x3e{point.name}\x3c/b\x3e: {point.value}\x3c/b\x3e\x3cbr/\x3e"},layoutAlgorithm:"sliceAndDice",layoutStartingDirection:"vertical",alternateStartingDirection:!1,levelIsConstant:!0,drillUpButton:{position:{align:"right",x:-10,y:10}}},{pointArrayMap:["value"],axisTypes:v.heatmap?["xAxis","yAxis","colorAxis"]:["xAxis","yAxis"],optionalAxis:"colorAxis",getSymbol:e,parallelArrays:["x","y","value","colorValue"],colorKey:"colorValue",translateColors:v.heatmap&&v.heatmap.prototype.translateColors,trackerGroups:["group","dataLabelsGroup"],getListOfParents:function(k,g){k=c(k,function(p,m,t){m=h(m.parent,"");void 0===p[m]&&(p[m]=[]);p[m].push(t);return p},{});q(k,function(m,p,t){""!==p&&-1===i.inArray(p,g)&&(f(m,function(u){t[""].push(u)}),delete t[p])});return k},getTree:function(){var k,g=this;k=b(this.data,function(m){return m.id});k=g.getListOfParents(this.data,k);g.nodeMap=[];k=g.buildNode("",-1,0,k,null);n(this.nodeMap[this.rootNode],function(m){var t=!1,p=m.parent;m.visible=!0;if(p||""===p){t=g.nodeMap[p]}return t});n(this.nodeMap[this.rootNode].children,function(p){var m=!1;f(p,function(t){t.visible=!0;t.children.length&&(m=(m||[]).concat(t.children))});return m});this.setTreeValues(k);return k},init:function(k,g){r.prototype.init.call(this,k,g);this.options.allowDrillToNode&&this.drillTo()},buildNode:function(x,w,u,p,t){var m=this,k=[],g=m.points[w],y;f(p[x]||[],function(z){y=m.buildNode(m.points[z].id,z,u+1,p,x);k.push(y)});w={id:x,i:w,children:k,level:u,parent:t,visible:!1};m.nodeMap[w.id]=w;g&&(g.node=w);return w},setTreeValues:function(k){var g=this,w=g.options,t=0,u=[],p,m=g.points[k.i];f(k.children,function(x){x=g.setTreeValues(x);u.push(x);x.ignore?n(x.children,function(z){var y=!1;f(z,function(A){j(A,{ignore:!0,isLeaf:!1,visible:!1});A.children.length&&(y=(y||[]).concat(A.children))});return y}):t+=x.val});s(u,function(y,x){return y.sortIndex-x.sortIndex});p=h(m&&m.options.value,t);m&&(m.value=p);j(k,{children:u,childrenTotal:t,ignore:!(h(m&&m.visible,!0)&&0<p),isLeaf:k.visible&&!t,levelDynamic:w.levelIsConstant?k.level:k.level-g.nodeMap[g.rootNode].level,name:h(m&&m.name,""),sortIndex:h(m&&m.sortIndex,-p),val:p});return k},calculateChildrenAreas:function(m,k){var y=this,w=y.options,x=this.levelMap[m.levelDynamic+1],u=h(y[x&&x.layoutAlgorithm]&&x.layoutAlgorithm,w.layoutAlgorithm),p=w.alternateStartingDirection,t=[];m=l(m.children,function(g){return !g.ignore});x&&x.layoutStartingDirection&&(k.direction="vertical"===x.layoutStartingDirection?0:1);t=y[u](k,m);f(m,function(g,z){z=t[z];g.values=o(z,{val:g.childrenTotal,direction:p?1-k.direction:k.direction});g.pointValues=o(z,{x:z.x/y.axisRatio,width:z.width/y.axisRatio});g.children.length&&y.calculateChildrenAreas(g,g.values)})},setPointValues:function(){var k=this.xAxis,g=this.yAxis;f(this.points,function(w){var t=w.node,u=t.pointValues,p,m;u&&t.visible?(t=Math.round(k.translate(u.x,0,0,0,1))-0.5,p=Math.round(k.translate(u.x+u.width,0,0,0,1))-0.5,m=Math.round(g.translate(u.y,0,0,0,1))-0.5,u=Math.round(g.translate(u.y+u.height,0,0,0,1))-0.5,w.shapeType="rect",w.shapeArgs={x:Math.min(t,p),y:Math.min(m,u),width:Math.abs(p-t),height:Math.abs(u-m)},w.plotX=w.shapeArgs.x+w.shapeArgs.width/2,w.plotY=w.shapeArgs.y+w.shapeArgs.height/2):(delete w.plotX,delete w.plotY)})},setColorRecursive:function(k,g,u){var p=this,t,m;k&&(t=p.points[k.i],m=p.levelMap[k.levelDynamic],g=h(t&&t.options.color,m&&m.color,g),u=h(t&&t.options.colorIndex,m&&m.colorIndex,u),t&&(t.color=g,t.colorIndex=u),k.children.length&&f(k.children,function(w){p.setColorRecursive(w,g,u)}))},algorithmGroup:function(k,g,p,m){this.height=k;this.width=g;this.plot=m;this.startDirection=this.direction=p;this.lH=this.nH=this.lW=this.nW=this.total=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(u,t){return Math.max(u/t,t/u)}};this.addElement=function(t){this.lP.total=this.elArr[this.elArr.length-1];this.total+=t;0===this.direction?(this.lW=this.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,this.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH));this.elArr.push(t)};this.reset=function(){this.lW=this.nW=0;this.elArr=[];this.total=0}},algorithmCalcPoints:function(F,E,D,A){var B,z,x,y,G=D.lW,t=D.lH,u=D.plot,w,p=0,m=D.elArr.length-1;E?(G=D.nW,t=D.nH):w=D.elArr[D.elArr.length-1];f(D.elArr,function(g){if(E||p<m){0===D.direction?(B=u.x,z=u.y,x=G,y=g/x):(B=u.x,z=u.y,y=t,x=g/y),A.push({x:B,y:z,width:x,height:y}),0===D.direction?u.y+=y:u.x+=x}p+=1});D.reset();0===D.direction?D.width-=G:D.height-=t;u.y=u.parent.y+(u.parent.height-D.height);u.x=u.parent.x+(u.parent.width-D.width);F&&(D.direction=1-D.direction);E||D.addElement(w)},algorithmLowAspectRatio:function(B,A,z){var x=[],y=this,w,t={x:A.x,y:A.y,parent:A},u=0,p=z.length-1,m=new this.algorithmGroup(A.height,A.width,A.direction,t);f(z,function(g){w=g.val/A.val*A.height*A.width;m.addElement(w);m.lP.nR>m.lP.lR&&y.algorithmCalcPoints(B,!1,m,x,t);u===p&&y.algorithmCalcPoints(B,!0,m,x,t);u+=1});return x},algorithmFill:function(H,G,F){var D=[],E,B=G.direction,z=G.x,A=G.y,y=G.width,w=G.height,x,u,t,m;f(F,function(g){E=g.val/G.val*G.height*G.width;x=z;u=A;0===B?(m=w,t=E/m,y-=t,z+=t):(t=y,m=E/t,w-=m,A+=m);D.push({x:x,y:u,width:t,height:m});H&&(B=1-B)});return D},strip:function(k,g){return this.algorithmLowAspectRatio(!1,k,g)},squarified:function(k,g){return this.algorithmLowAspectRatio(!0,k,g)},sliceAndDice:function(k,g){return this.algorithmFill(!0,k,g)},stripes:function(k,g){return this.algorithmFill(!1,k,g)},translate:function(){var k,g;r.prototype.translate.call(this);this.rootNode=h(this.options.rootId,"");this.levelMap=c(this.options.levels,function(p,m){p[m.level]=m;return p},{});g=this.tree=this.getTree();this.axisRatio=this.xAxis.len/this.yAxis.len;this.nodeMap[""].pointValues=k={x:0,y:0,width:100,height:100};this.nodeMap[""].values=k=o(k,{width:k.width*this.axisRatio,direction:"vertical"===this.options.layoutStartingDirection?0:1,val:g.val});this.calculateChildrenAreas(g,k);this.colorAxis?this.translateColors():this.options.colorByPoint||this.setColorRecursive(this.tree);this.options.allowDrillToNode&&(g=this.nodeMap[this.rootNode].pointValues,this.xAxis.setExtremes(g.x,g.x+g.width,!1),this.yAxis.setExtremes(g.y,g.y+g.height,!1),this.xAxis.setScale(),this.yAxis.setScale());this.setPointValues()},drawDataLabels:function(){var k=this,g=l(k.points,function(t){return t.node.visible}),p,m;f(g,function(t){m=k.levelMap[t.node.levelDynamic];p={style:{}};t.node.isLeaf||(p.enabled=!1);m&&m.dataLabels&&(p=o(p,m.dataLabels),k._hasPointLabels=!0);t.shapeArgs&&(p.style.width=t.shapeArgs.width,t.dataLabel&&t.dataLabel.css({width:t.shapeArgs.width+"px"}));t.dlOptions=o(p,t.options.dataLabels)});r.prototype.drawDataLabels.call(this)},alignDataLabel:function(g){v.column.prototype.alignDataLabel.apply(this,arguments);g.dataLabel&&g.dataLabel.attr({zIndex:g.node.zIndex+1})},drawPoints:function(){var k=this,g=l(k.points,function(m){return m.node.visible});f(g,function(m){var p="levelGroup-"+m.node.levelDynamic;k[p]||(k[p]=k.chart.renderer.g(p).attr({zIndex:1000-m.node.levelDynamic}).add(k.group));m.group=k[p]});v.column.prototype.drawPoints.call(this);k.options.allowDrillToNode&&f(g,function(m){m.graphic&&(m.drillId=k.options.interactByLeaf?k.drillToByLeaf(m):k.drillToByGroup(m))})},drillTo:function(){var g=this;i.addEvent(g,"click",function(k){k=k.point;var p=k.drillId,m;p&&(m=g.nodeMap[g.rootNode].name||g.rootNode,k.setState(""),g.drillToNode(p),g.showDrillUpButton(m))})},drillToByGroup:function(k){var g=!1;1!==k.node.level-this.nodeMap[this.rootNode].level||k.node.isLeaf||(g=k.id);return g},drillToByLeaf:function(k){var g=!1;if(k.node.parent!==this.rootNode&&k.node.isLeaf){for(k=k.node;!g;){k=this.nodeMap[k.parent],k.parent===this.rootNode&&(g=k.id)}}return g},drillUp:function(){var g=null;this.rootNode&&(g=this.nodeMap[this.rootNode],g=null!==g.parent?this.nodeMap[g.parent]:this.nodeMap[""]);null!==g&&(this.drillToNode(g.id),""===g.id?this.drillUpButton=this.drillUpButton.destroy():(g=this.nodeMap[g.parent],this.showDrillUpButton(g.name||g.id)))},drillToNode:function(g){this.options.rootId=g;this.isDirty=!0;this.chart.redraw()},showDrillUpButton:function(k){var g=this;k=k||"\x3c Back";var t=g.options.drillUpButton,m,p;t.text&&(k=t.text);this.drillUpButton?this.drillUpButton.attr({text:k}).align():(p=(m=t.theme)&&m.states,this.drillUpButton=this.chart.renderer.button(k,null,null,function(){g.drillUp()},m,p&&p.hover,p&&p.select).attr({align:t.position.align,zIndex:7}).add().align(t.position,!1,t.relativeTo||"plotBox"))},buildKDTree:e,drawLegendSymbol:i.LegendSymbolMixin.drawRectangle,getExtremes:function(){r.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;r.prototype.getExtremes.call(this)},getExtremesFromAll:!0,bindAxes:function(){var g={endOnTick:!1,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};r.prototype.bindAxes.call(this);i.extend(this.yAxis.options,g);i.extend(this.xAxis.options,g)}},{getClassName:function(){var k=i.Point.prototype.getClassName.call(this),g=this.series,m=g.options;this.node.level<=g.nodeMap[g.rootNode].level?k+=" highcharts-above-level":this.node.isLeaf||h(m.interactByLeaf,!m.allowDrillToNode)?this.node.isLeaf||(k+=" highcharts-internal-node"):k+=" highcharts-internal-node-interactive";return k},isValid:function(){return C(this.value)},setState:function(g){i.Point.prototype.setState.call(this,g);this.graphic.attr({zIndex:"hover"===g?1:0})},setVisible:v.pie.prototype.pointClass.prototype.setVisible})})(a)});