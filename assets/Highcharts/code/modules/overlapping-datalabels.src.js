(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(c){var b=c.Chart,f=c.each,d=c.pick,e=c.addEvent;b.prototype.callbacks.push(function(g){function h(){var i=[];f(g.series,function(k){var j=k.options.dataLabels,l=k.dataLabelCollections||["dataLabel"];if((j.enabled||k._hasPointLabels)&&!j.allowOverlap&&k.visible){f(l,function(m){f(k.points,function(n){if(n[m]){n[m].labelrank=d(n.labelrank,n.shapeArgs&&n.shapeArgs.height);i.push(n[m])}})})}});g.hideOverlappingLabels(i)}h();e(g,"redraw",h)});b.prototype.hideOverlappingLabels=function(m){var n=m.length,t,l,k,h,g,v,s,q,p,o,r,u=function(y,B,j,A,w,z,i,x){return !(w>y+j||w+i<y||z>B+A||z+x<B)};for(l=0;l<n;l++){t=m[l];if(t){t.oldOpacity=t.opacity;t.newOpacity=1}}m.sort(function(j,i){return(i.labelrank||0)-(j.labelrank||0)});for(l=0;l<n;l++){h=m[l];for(k=l+1;k<n;++k){g=m[k];if(h&&g&&h.placed&&g.placed&&h.newOpacity!==0&&g.newOpacity!==0){s=h.alignAttr;q=g.alignAttr;p=h.parentGroup;o=g.parentGroup;r=2*(h.box?0:h.padding);v=u(s.x+p.translateX,s.y+p.translateY,h.width-r,h.height-r,q.x+o.translateX,q.y+o.translateY,g.width-r,g.height-r);if(v){(h.labelrank<g.labelrank?h:g).newOpacity=0}}}}f(m,function(j){var i,w;if(j){w=j.newOpacity;if(j.oldOpacity!==w&&j.placed){if(w){j.show(true)}else{i=function(){j.hide()}}j.alignAttr.opacity=w;j[j.isOld?"animate":"attr"](j.alignAttr,null,i)}j.isOld=true}})}}(a))}));