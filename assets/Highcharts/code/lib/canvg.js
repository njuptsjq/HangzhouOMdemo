(function(a,b){"undefined"!==typeof define&&define.amd?define("canvgModule",["rgbcolor","stackblur"],b):"undefined"!==typeof module&&module.exports&&(module.exports=b(require("rgbcolor"),require("stackblur")));a.canvg=b(a.RGBColor,a.stackBlur)})("undefined"!==typeof window?window:this,function(g,f){function d(q){var p=[0,0,0],o=function(t,r){var s=q.match(t);null!=s&&(p[r]+=s.length,q=q.replace(t," "))};q=q.replace(/:not\(([^\)]*)\)/g,"     $1 ");q=q.replace(/{[^]*/gm," ");o(c,1);o(b,0);o(a,1);o(n,2);o(m,1);o(l,1);q=q.replace(/[\*\s\+>~]/g," ");q=q.replace(/[#\.]/g," ");o(k,2);return p.join("")}function h(q){var p={opts:q,FRAMERATE:30,MAX_VIRTUAL_PIXELS:30000,log:function(r){}};1==p.opts.log&&"undefined"!=typeof console&&(p.log=function(r){console.log(r)});p.init=function(s){var r=0;p.UniqueId=function(){r++;return"canvg"+r};p.Definitions={};p.Styles={};p.StylesSpecificity={};p.Animations=[];p.Images=[];p.ctx=s;p.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(u,t){this.viewPorts.push({width:u,height:t})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}};p.init();p.ImagesLoaded=function(){for(var r=0;r<p.Images.length;r++){if(!p.Images[r].loaded){return !1}}return !0};p.trim=function(r){return r.replace(/^\s+|\s+$/g,"")};p.compressSpaces=function(r){return r.replace(/[\s\r\t\n]+/gm," ")};p.ajax=function(s){var r;r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.open("GET",s,!1);r.send(null);return r.responseText};p.parseXml=function(s){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var r=new Windows.Data.Xml.Dom.XmlDocument,t=new Windows.Data.Xml.Dom.XmlLoadSettings;t.prohibitDtd=!1;r.loadXml(s,t);return r}if(window.DOMParser){return(new DOMParser).parseFromString(s,"text/xml")}s=s.replace(/<!DOCTYPE svg[^>]*>/,"");r=new ActiveXObject("Microsoft.XMLDOM");r.async="false";r.loadXML(s);return r};p.Property=function(s,r){this.name=s;this.value=r};p.Property.prototype.getValue=function(){return this.value};p.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value};p.Property.prototype.numValue=function(){if(!this.hasValue()){return 0}var r=parseFloat(this.value);(this.value+"").match(/%$/)&&(r/=100);return r};p.Property.prototype.valueOrDefault=function(r){return this.hasValue()?this.value:r};p.Property.prototype.numValueOrDefault=function(r){return this.hasValue()?this.numValue():r};p.Property.prototype.addOpacity=function(t){var r=this.value;if(null!=t.value&&""!=t.value&&"string"==typeof this.value){var s=new g(this.value);s.ok&&(r="rgba("+s.r+", "+s.g+", "+s.b+", "+t.numValue()+")")}return new p.Property(this.name,r)};p.Property.prototype.getDefinition=function(){var r=this.value.match(/#([^\)'"]+)/);r&&(r=r[1]);r||(r=this.value);return p.Definitions[r]};p.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")};p.Property.prototype.getFillStyleDefinition=function(u,r){var s=this.getDefinition();if(null!=s&&s.createGradient){return s.createGradient(p.ctx,u,r)}if(null!=s&&s.createPattern){if(s.getHrefAttribute().hasValue()){var t=s.attribute("patternTransform"),s=s.getHrefAttribute().getDefinition();t.hasValue()&&(s.attribute("patternTransform",!0).value=t.value)}return s.createPattern(p.ctx,u)}return null};p.Property.prototype.getDPI=function(r){return 96};p.Property.prototype.getEM=function(t){var r=12,s=new p.Property("fontSize",p.Font.Parse(p.ctx.font).fontSize);s.hasValue()&&(r=s.toPixels(t));return r};p.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")};p.Property.prototype.toPixels=function(t,r){if(!this.hasValue()){return 0}var s=this.value+"";if(s.match(/em$/)){return this.numValue()*this.getEM(t)}if(s.match(/ex$/)){return this.numValue()*this.getEM(t)/2}if(s.match(/px$/)){return this.numValue()}if(s.match(/pt$/)){return this.numValue()*this.getDPI(t)*(1/72)}if(s.match(/pc$/)){return 15*this.numValue()}if(s.match(/cm$/)){return this.numValue()*this.getDPI(t)/2.54}if(s.match(/mm$/)){return this.numValue()*this.getDPI(t)/25.4}if(s.match(/in$/)){return this.numValue()*this.getDPI(t)}if(s.match(/%$/)){return this.numValue()*p.ViewPort.ComputeSize(t)}s=this.numValue();return r&&1>s?s*p.ViewPort.ComputeSize(t):s};p.Property.prototype.toMilliseconds=function(){if(!this.hasValue()){return 0}var r=this.value+"";if(r.match(/s$/)){return 1000*this.numValue()}r.match(/ms$/);return this.numValue()};p.Property.prototype.toRadians=function(){if(!this.hasValue()){return 0}var r=this.value+"";return r.match(/deg$/)?this.numValue()*(Math.PI/180):r.match(/grad$/)?this.numValue()*(Math.PI/200):r.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var o={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};p.Property.prototype.toTextBaseline=function(){return this.hasValue()?o[this.value]:null};p.Font=new function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(s,v,w,x,u,t){t=null!=t?this.Parse(t):this.CreateFont("","","","","",p.ctx.font);return{fontFamily:u||t.fontFamily,fontSize:x||t.fontSize,fontStyle:s||t.fontStyle,fontWeight:w||t.fontWeight,fontVariant:v||t.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var r=this;this.Parse=function(t){var x={};t=p.trim(p.compressSpaces(t||"")).split(" ");for(var y=!1,u=!1,w=!1,v=!1,s="",z=0;z<t.length;z++){u||-1==r.Styles.indexOf(t[z])?v||-1==r.Variants.indexOf(t[z])?w||-1==r.Weights.indexOf(t[z])?y?"inherit"!=t[z]&&(s+=t[z]):("inherit"!=t[z]&&(x.fontSize=t[z].split("/")[0]),u=v=w=y=!0):("inherit"!=t[z]&&(x.fontWeight=t[z]),u=v=w=!0):("inherit"!=t[z]&&(x.fontVariant=t[z]),u=v=!0):("inherit"!=t[z]&&(x.fontStyle=t[z]),u=!0)}""!=s&&(x.fontFamily=s);return x}};p.ToNumberArray=function(s){s=p.trim(p.compressSpaces((s||"").replace(/,/g," "))).split(" ");for(var r=0;r<s.length;r++){s[r]=parseFloat(s[r])}return s};p.Point=function(s,r){this.x=s;this.y=r};p.Point.prototype.angleTo=function(r){return Math.atan2(r.y-this.y,r.x-this.x)};p.Point.prototype.applyTransform=function(s){var r=this.x*s[1]+this.y*s[3]+s[5];this.x=this.x*s[0]+this.y*s[2]+s[4];this.y=r};p.CreatePoint=function(r){r=p.ToNumberArray(r);return new p.Point(r[0],r[1])};p.CreatePath=function(t){t=p.ToNumberArray(t);for(var r=[],s=0;s<t.length;s+=2){r.push(new p.Point(t[s],t[s+1]))}return r};p.BoundingBox=function(s,r,t,u){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(w,v){if(null!=w){if(isNaN(this.x1)||isNaN(this.x2)){this.x2=this.x1=w}w<this.x1&&(this.x1=w);w>this.x2&&(this.x2=w)}if(null!=v){if(isNaN(this.y1)||isNaN(this.y2)){this.y2=this.y1=v}v<this.y1&&(this.y1=v);v>this.y2&&(this.y2=v)}};this.addX=function(v){this.addPoint(v,null)};this.addY=function(v){this.addPoint(null,v)};this.addBoundingBox=function(v){this.addPoint(v.x1,v.y1);this.addPoint(v.x2,v.y2)};this.addQuadraticCurve=function(w,v,y,z,A,x){y=w+2/3*(y-w);z=v+2/3*(z-v);this.addBezierCurve(w,v,y,y+1/3*(A-w),z,z+1/3*(x-v),A,x)};this.addBezierCurve=function(E,D,A,B,C,v,F,x){var G=[E,D],z=[A,B],w=[C,v],y=[F,x];this.addPoint(G[0],G[1]);this.addPoint(y[0],y[1]);for(i=0;1>=i;i++){E=function(H){return Math.pow(1-H,3)*G[i]+3*Math.pow(1-H,2)*H*z[i]+3*(1-H)*Math.pow(H,2)*w[i]+Math.pow(H,3)*y[i]},D=6*G[i]-12*z[i]+6*w[i],A=-3*G[i]+9*z[i]-9*w[i]+3*y[i],B=3*z[i]-3*G[i],0==A?0!=D&&(D=-B/D,0<D&&1>D&&(0==i&&this.addX(E(D)),1==i&&this.addY(E(D)))):(B=Math.pow(D,2)-4*B*A,0>B||(C=(-D+Math.sqrt(B))/(2*A),0<C&&1>C&&(0==i&&this.addX(E(C)),1==i&&this.addY(E(C))),D=(-D-Math.sqrt(B))/(2*A),0<D&&1>D&&(0==i&&this.addX(E(D)),1==i&&this.addY(E(D)))))}};this.isPointInBox=function(w,v){return this.x1<=w&&w<=this.x2&&this.y1<=v&&v<=this.y2};this.addPoint(s,r);this.addPoint(t,u)};p.Transform=function(v){var r=this;this.Type={};this.Type.translate=function(w){this.p=p.CreatePoint(w);this.apply=function(x){x.translate(this.p.x||0,this.p.y||0)};this.unapply=function(x){x.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(x){x.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(w){w=p.ToNumberArray(w);this.angle=new p.Property("angle",w[0]);this.cx=w[1]||0;this.cy=w[2]||0;this.apply=function(x){x.translate(this.cx,this.cy);x.rotate(this.angle.toRadians());x.translate(-this.cx,-this.cy)};this.unapply=function(x){x.translate(this.cx,this.cy);x.rotate(-1*this.angle.toRadians());x.translate(-this.cx,-this.cy)};this.applyToPoint=function(y){var x=this.angle.toRadians();y.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);y.applyTransform([Math.cos(x),Math.sin(x),-Math.sin(x),Math.cos(x),0,0]);y.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(w){this.p=p.CreatePoint(w);this.apply=function(x){x.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(x){x.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(x){x.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(w){this.m=p.ToNumberArray(w);this.apply=function(x){x.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.unapply=function(y){var x=this.m[0],C=this.m[2],D=this.m[4],E=this.m[1],B=this.m[3],z=this.m[5],A=1/(x*(1*B-0*z)-C*(1*E-0*z)+D*(0*E-0*B));y.transform(A*(1*B-0*z),A*(0*z-1*E),A*(0*D-1*C),A*(1*x-0*D),A*(C*z-D*B),A*(D*E-x*z))};this.applyToPoint=function(x){x.applyTransform(this.m)}};this.Type.SkewBase=function(w){this.base=r.Type.matrix;this.base(w);this.angle=new p.Property("angle",w)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(w){this.base=r.Type.SkewBase;this.base(w);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(w){this.base=r.Type.SkewBase;this.base(w);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(x){for(var w=0;w<this.transforms.length;w++){this.transforms[w].apply(x)}};this.unapply=function(x){for(var w=this.transforms.length-1;0<=w;w--){this.transforms[w].unapply(x)}};this.applyToPoint=function(x){for(var w=0;w<this.transforms.length;w++){this.transforms[w].applyToPoint(x)}};v=p.trim(p.compressSpaces(v)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/);for(var t=0;t<v.length;t++){var u=p.trim(v[t].split("(")[0]),s=v[t].split("(")[1].replace(")",""),s=new this.Type[u](s);s.type=u;this.transforms.push(s)}};p.AspectRatio=function(F,G,D,E,z,C,B,x,w,s){G=p.compressSpaces(G);G=G.replace(/^defer\s/,"");var A=G.split(" ")[0]||"xMidYMid";G=G.split(" ")[1]||"meet";var v=D/E,H=z/C,y=Math.min(v,H),u=Math.max(v,H);"meet"==G&&(E*=y,C*=y);"slice"==G&&(E*=u,C*=u);w=new p.Property("refX",w);s=new p.Property("refY",s);w.hasValue()&&s.hasValue()?F.translate(-y*w.toPixels("x"),-y*s.toPixels("y")):(A.match(/^xMid/)&&("meet"==G&&y==H||"slice"==G&&u==H)&&F.translate(D/2-E/2,0),A.match(/YMid$/)&&("meet"==G&&y==v||"slice"==G&&u==v)&&F.translate(0,z/2-C/2),A.match(/^xMax/)&&("meet"==G&&y==H||"slice"==G&&u==H)&&F.translate(D-E,0),A.match(/YMax$/)&&("meet"==G&&y==v||"slice"==G&&u==v)&&F.translate(0,z-C));"none"==A?F.scale(v,H):"meet"==G?F.scale(y,y):"slice"==G&&F.scale(u,u);F.translate(null==B?0:-B,null==x?0:-x)};p.Element={};p.EmptyProperty=new p.Property("EMPTY","");p.Element.ElementBase=function(v){this.attributes={};this.styles={};this.stylesSpecificity={};this.children=[];this.attribute=function(w,x){var y=this.attributes[w];if(null!=y){return y}1==x&&(y=new p.Property(w,""),this.attributes[w]=y);return y||p.EmptyProperty};this.getHrefAttribute=function(){for(var w in this.attributes){if("href"==w||w.match(/:href$/)){return this.attributes[w]}}return p.EmptyProperty};this.style=function(w,y,z){var A=this.styles[w];if(null!=A){return A}var x=this.attribute(w);if(null!=x&&x.hasValue()){return this.styles[w]=x}if(1!=z&&(z=this.parent,null!=z&&(z=z.style(w),null!=z&&z.hasValue()))){return z}1==y&&(A=new p.Property(w,""),this.styles[w]=A);return A||p.EmptyProperty};this.render=function(x){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){x.save();if(this.style("mask").hasValue()){var w=this.style("mask").getDefinition();null!=w&&w.apply(x,this)}else{this.style("filter").hasValue()?(w=this.style("filter").getDefinition(),null!=w&&w.apply(x,this)):(this.setContext(x),this.renderChildren(x),this.clearContext(x))}x.restore()}};this.setContext=function(w){};this.clearContext=function(w){};this.renderChildren=function(x){for(var w=0;w<this.children.length;w++){this.children[w].render(x)}};this.addChild=function(w,x){var y=w;x&&(y=p.CreateElement(w));y.parent=this;"title"!=y.type&&this.children.push(y)};this.addStylesFromStyleDefinition=function(){for(var w in p.Styles){if("@"!=w[0]&&j(v,w)){var z=p.Styles[w],A=p.StylesSpecificity[w];if(null!=z){for(var x in z){var y=this.stylesSpecificity[x];"undefined"==typeof y&&(y="000");A>y&&(this.styles[x]=z[x],this.stylesSpecificity[x]=A)}}}}};if(null!=v&&1==v.nodeType){for(var r=0;r<v.attributes.length;r++){var t=v.attributes[r];this.attributes[t.nodeName]=new p.Property(t.nodeName,t.value)}this.addStylesFromStyleDefinition();if(this.attribute("style").hasValue()){for(t=this.attribute("style").value.split(";"),r=0;r<t.length;r++){if(""!=p.trim(t[r])){var u=t[r].split(":"),s=p.trim(u[0]),u=p.trim(u[1]);this.styles[s]=new p.Property(s,u)}}}this.attribute("id").hasValue()&&null==p.Definitions[this.attribute("id").value]&&(p.Definitions[this.attribute("id").value]=this);for(r=0;r<v.childNodes.length;r++){t=v.childNodes[r],1==t.nodeType&&this.addChild(t,!0),!this.captureTextNodes||3!=t.nodeType&&4!=t.nodeType||""!=p.compressSpaces(t.value||t.text||t.textContent||"")&&this.addChild(new p.Element.tspan(t),!1)}}};p.Element.RenderedElementBase=function(r){this.base=p.Element.ElementBase;this.base(r);this.setContext=function(s){if(this.style("fill").isUrlDefinition()){var t=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=t&&(s.fillStyle=t)}else{this.style("fill").hasValue()&&(t=this.style("fill"),"currentColor"==t.value&&(t.value=this.style("color").value),"inherit"!=t.value&&(s.fillStyle="none"==t.value?"rgba(0,0,0,0)":t.value))}this.style("fill-opacity").hasValue()&&(t=new p.Property("fill",s.fillStyle),t=t.addOpacity(this.style("fill-opacity")),s.fillStyle=t.value);this.style("stroke").isUrlDefinition()?(t=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")),null!=t&&(s.strokeStyle=t)):this.style("stroke").hasValue()&&(t=this.style("stroke"),"currentColor"==t.value&&(t.value=this.style("color").value),"inherit"!=t.value&&(s.strokeStyle="none"==t.value?"rgba(0,0,0,0)":t.value));this.style("stroke-opacity").hasValue()&&(t=new p.Property("stroke",s.strokeStyle),t=t.addOpacity(this.style("stroke-opacity")),s.strokeStyle=t.value);this.style("stroke-width").hasValue()&&(t=this.style("stroke-width").toPixels(),s.lineWidth=0==t?0.001:t);this.style("stroke-linecap").hasValue()&&(s.lineCap=this.style("stroke-linecap").value);this.style("stroke-linejoin").hasValue()&&(s.lineJoin=this.style("stroke-linejoin").value);this.style("stroke-miterlimit").hasValue()&&(s.miterLimit=this.style("stroke-miterlimit").value);this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value&&(t=p.ToNumberArray(this.style("stroke-dasharray").value),"undefined"!=typeof s.setLineDash?s.setLineDash(t):"undefined"!=typeof s.webkitLineDash?s.webkitLineDash=t:"undefined"==typeof s.mozDash||1==t.length&&0==t[0]||(s.mozDash=t),t=this.style("stroke-dashoffset").numValueOrDefault(1),"undefined"!=typeof s.lineDashOffset?s.lineDashOffset=t:"undefined"!=typeof s.webkitLineDashOffset?s.webkitLineDashOffset=t:"undefined"!=typeof s.mozDashOffset&&(s.mozDashOffset=t));"undefined"!=typeof s.font&&(s.font=p.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString());this.style("transform",!1,!0).hasValue()&&(new p.Transform(this.style("transform",!1,!0).value)).apply(s);this.style("clip-path",!1,!0).hasValue()&&(t=this.style("clip-path",!1,!0).getDefinition(),null!=t&&t.apply(s));this.style("opacity").hasValue()&&(s.globalAlpha=this.style("opacity").numValue())}};p.Element.RenderedElementBase.prototype=new p.Element.ElementBase;p.Element.PathElementBase=function(r){this.base=p.Element.RenderedElementBase;this.base(r);this.path=function(s){null!=s&&s.beginPath();return new p.BoundingBox};this.renderChildren=function(s){this.path(s);p.Mouse.checkPath(this,s);""!=s.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?s.fill(this.style("fill-rule").value):s.fill());""!=s.strokeStyle&&s.stroke();var t=this.getMarkers();if(null!=t){if(this.style("marker-start").isUrlDefinition()){var u=this.style("marker-start").getDefinition();u.render(s,t[0][0],t[0][1])}if(this.style("marker-mid").isUrlDefinition()){for(var u=this.style("marker-mid").getDefinition(),v=1;v<t.length-1;v++){u.render(s,t[v][0],t[v][1])}}this.style("marker-end").isUrlDefinition()&&(u=this.style("marker-end").getDefinition(),u.render(s,t[t.length-1][0],t[t.length-1][1]))}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};p.Element.PathElementBase.prototype=new p.Element.RenderedElementBase;p.Element.svg=function(r){this.base=p.Element.RenderedElementBase;this.base(r);this.baseClearContext=this.clearContext;this.clearContext=function(s){this.baseClearContext(s);p.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(s){s.strokeStyle="rgba(0,0,0,0)";s.lineCap="butt";s.lineJoin="miter";s.miterLimit=4;"undefined"!=typeof s.font&&"undefined"!=typeof window.getComputedStyle&&(s.font=window.getComputedStyle(s.canvas).getPropertyValue("font"));this.baseSetContext(s);this.attribute("x").hasValue()||(this.attribute("x",!0).value=0);this.attribute("y").hasValue()||(this.attribute("y",!0).value=0);s.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var v=p.ViewPort.width(),w=p.ViewPort.height();this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%");this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%");if("undefined"==typeof this.root){var v=this.attribute("width").toPixels("x"),w=this.attribute("height").toPixels("y"),x=0,u=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(x=-this.attribute("refX").toPixels("x"),u=-this.attribute("refY").toPixels("y"));"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(s.beginPath(),s.moveTo(x,u),s.lineTo(v,u),s.lineTo(v,w),s.lineTo(x,w),s.closePath(),s.clip())}p.ViewPort.SetCurrent(v,w);if(this.attribute("viewBox").hasValue()){var x=p.ToNumberArray(this.attribute("viewBox").value),u=x[0],t=x[1],v=x[2],w=x[3];p.AspectRatio(s,this.attribute("preserveAspectRatio").value,p.ViewPort.width(),v,p.ViewPort.height(),w,u,t,this.attribute("refX").value,this.attribute("refY").value);p.ViewPort.RemoveCurrent();p.ViewPort.SetCurrent(x[2],x[3])}}};p.Element.svg.prototype=new p.Element.RenderedElementBase;p.Element.rect=function(r){this.base=p.Element.PathElementBase;this.base(r);this.path=function(t){var w=this.attribute("x").toPixels("x"),x=this.attribute("y").toPixels("y"),y=this.attribute("width").toPixels("x"),v=this.attribute("height").toPixels("y"),u=this.attribute("rx").toPixels("x"),s=this.attribute("ry").toPixels("y");this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(s=u);this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(u=s);u=Math.min(u,y/2);s=Math.min(s,v/2);null!=t&&(t.beginPath(),t.moveTo(w+u,x),t.lineTo(w+y-u,x),t.quadraticCurveTo(w+y,x,w+y,x+s),t.lineTo(w+y,x+v-s),t.quadraticCurveTo(w+y,x+v,w+y-u,x+v),t.lineTo(w+u,x+v),t.quadraticCurveTo(w,x+v,w,x+v-s),t.lineTo(w,x+s),t.quadraticCurveTo(w,x,w+u,x),t.closePath());return new p.BoundingBox(w,x,w+y,x+v)}};p.Element.rect.prototype=new p.Element.PathElementBase;p.Element.circle=function(r){this.base=p.Element.PathElementBase;this.base(r);this.path=function(s){var t=this.attribute("cx").toPixels("x"),u=this.attribute("cy").toPixels("y"),v=this.attribute("r").toPixels();null!=s&&(s.beginPath(),s.arc(t,u,v,0,2*Math.PI,!0),s.closePath());return new p.BoundingBox(t-v,u-v,t+v,u+v)}};p.Element.circle.prototype=new p.Element.PathElementBase;p.Element.ellipse=function(r){this.base=p.Element.PathElementBase;this.base(r);this.path=function(s){var v=(Math.sqrt(2)-1)/3*4,w=this.attribute("rx").toPixels("x"),x=this.attribute("ry").toPixels("y"),u=this.attribute("cx").toPixels("x"),t=this.attribute("cy").toPixels("y");null!=s&&(s.beginPath(),s.moveTo(u,t-x),s.bezierCurveTo(u+v*w,t-x,u+w,t-v*x,u+w,t),s.bezierCurveTo(u+w,t+v*x,u+v*w,t+x,u,t+x),s.bezierCurveTo(u-v*w,t+x,u-w,t+v*x,u-w,t),s.bezierCurveTo(u-w,t-v*x,u-v*w,t-x,u,t-x),s.closePath());return new p.BoundingBox(u-w,t-x,u+w,t+x)}};p.Element.ellipse.prototype=new p.Element.PathElementBase;p.Element.line=function(r){this.base=p.Element.PathElementBase;this.base(r);this.getPoints=function(){return[new p.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new p.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(s){var t=this.getPoints();null!=s&&(s.beginPath(),s.moveTo(t[0].x,t[0].y),s.lineTo(t[1].x,t[1].y));return new p.BoundingBox(t[0].x,t[0].y,t[1].x,t[1].y)};this.getMarkers=function(){var s=this.getPoints(),t=s[0].angleTo(s[1]);return[[s[0],t],[s[1],t]]}};p.Element.line.prototype=new p.Element.PathElementBase;p.Element.polyline=function(r){this.base=p.Element.PathElementBase;this.base(r);this.points=p.CreatePath(this.attribute("points").value);this.path=function(s){var t=new p.BoundingBox(this.points[0].x,this.points[0].y);null!=s&&(s.beginPath(),s.moveTo(this.points[0].x,this.points[0].y));for(var u=1;u<this.points.length;u++){t.addPoint(this.points[u].x,this.points[u].y),null!=s&&s.lineTo(this.points[u].x,this.points[u].y)}return t};this.getMarkers=function(){for(var s=[],t=0;t<this.points.length-1;t++){s.push([this.points[t],this.points[t].angleTo(this.points[t+1])])}s.push([this.points[this.points.length-1],s[s.length-1][1]]);return s}};p.Element.polyline.prototype=new p.Element.PathElementBase;p.Element.polygon=function(r){this.base=p.Element.polyline;this.base(r);this.basePath=this.path;this.path=function(s){var t=this.basePath(s);null!=s&&(s.lineTo(this.points[0].x,this.points[0].y),s.closePath());return t}};p.Element.polygon.prototype=new p.Element.polyline;p.Element.path=function(s){this.base=p.Element.PathElementBase;this.base(s);s=this.attribute("d").value;s=s.replace(/,/gm," ");for(var r=0;2>r;r++){s=s.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2")}s=s.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");s=s.replace(/([0-9])([+\-])/gm,"$1 $2");for(r=0;2>r;r++){s=s.replace(/(\.[0-9]*)(\.)/gm,"$1 $2")}s=s.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");s=p.compressSpaces(s);s=p.trim(s);this.PathParser=new function(t){this.tokens=t.split(" ");this.reset=function(){this.i=-1;this.previousCommand=this.command="";this.start=new p.Point(0,0);this.control=new p.Point(0,0);this.current=new p.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)};this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return !0}return !1};this.getToken=function(){this.i++;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var u=new p.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(u)};this.getAsControlPoint=function(){var u=this.getPoint();return this.control=u};this.getAsCurrentPoint=function(){var u=this.getPoint();return this.current=u};this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new p.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)};this.makeAbsolute=function(u){this.isRelativeCommand()&&(u.x+=this.current.x,u.y+=this.current.y);return u};this.addMarker=function(v,u,w){null!=w&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(w));this.addMarkerAngle(v,null==u?null:u.angleTo(v))};this.addMarkerAngle=function(v,u){this.points.push(v);this.angles.push(u)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var v=0;v<this.angles.length;v++){if(null==this.angles[v]){for(var u=v+1;u<this.angles.length;u++){if(null!=this.angles[u]){this.angles[v]=this.angles[u];break}}}}return this.angles}}(s);this.path=function(H){var F=this.PathParser;F.reset();var G=new p.BoundingBox;for(null!=H&&H.beginPath();!F.isEnd();){switch(F.nextCommand(),F.command){case"M":case"m":var E=F.getAsCurrentPoint();F.addMarker(E);G.addPoint(E.x,E.y);null!=H&&H.moveTo(E.x,E.y);for(F.start=F.current;!F.isCommandOrEnd();){E=F.getAsCurrentPoint(),F.addMarker(E,F.start),G.addPoint(E.x,E.y),null!=H&&H.lineTo(E.x,E.y)}break;case"L":case"l":for(;!F.isCommandOrEnd();){var D=F.current,E=F.getAsCurrentPoint();F.addMarker(E,D);G.addPoint(E.x,E.y);null!=H&&H.lineTo(E.x,E.y)}break;case"H":case"h":for(;!F.isCommandOrEnd();){E=new p.Point((F.isRelativeCommand()?F.current.x:0)+F.getScalar(),F.current.y),F.addMarker(E,F.current),F.current=E,G.addPoint(F.current.x,F.current.y),null!=H&&H.lineTo(F.current.x,F.current.y)}break;case"V":case"v":for(;!F.isCommandOrEnd();){E=new p.Point(F.current.x,(F.isRelativeCommand()?F.current.y:0)+F.getScalar()),F.addMarker(E,F.current),F.current=E,G.addPoint(F.current.x,F.current.y),null!=H&&H.lineTo(F.current.x,F.current.y)}break;case"C":case"c":for(;!F.isCommandOrEnd();){var A=F.current,D=F.getPoint(),z=F.getAsControlPoint(),E=F.getAsCurrentPoint();F.addMarker(E,z,D);G.addBezierCurve(A.x,A.y,D.x,D.y,z.x,z.y,E.x,E.y);null!=H&&H.bezierCurveTo(D.x,D.y,z.x,z.y,E.x,E.y)}break;case"S":case"s":for(;!F.isCommandOrEnd();){A=F.current,D=F.getReflectedControlPoint(),z=F.getAsControlPoint(),E=F.getAsCurrentPoint(),F.addMarker(E,z,D),G.addBezierCurve(A.x,A.y,D.x,D.y,z.x,z.y,E.x,E.y),null!=H&&H.bezierCurveTo(D.x,D.y,z.x,z.y,E.x,E.y)}break;case"Q":case"q":for(;!F.isCommandOrEnd();){A=F.current,z=F.getAsControlPoint(),E=F.getAsCurrentPoint(),F.addMarker(E,z,z),G.addQuadraticCurve(A.x,A.y,z.x,z.y,E.x,E.y),null!=H&&H.quadraticCurveTo(z.x,z.y,E.x,E.y)}break;case"T":case"t":for(;!F.isCommandOrEnd();){A=F.current,z=F.getReflectedControlPoint(),F.control=z,E=F.getAsCurrentPoint(),F.addMarker(E,z,z),G.addQuadraticCurve(A.x,A.y,z.x,z.y,E.x,E.y),null!=H&&H.quadraticCurveTo(z.x,z.y,E.x,E.y)}break;case"A":case"a":for(;!F.isCommandOrEnd();){var A=F.current,t=F.getScalar(),C=F.getScalar(),D=F.getScalar()*(Math.PI/180),y=F.getScalar(),z=F.getScalar(),E=F.getAsCurrentPoint(),B=new p.Point(Math.cos(D)*(A.x-E.x)/2+Math.sin(D)*(A.y-E.y)/2,-Math.sin(D)*(A.x-E.x)/2+Math.cos(D)*(A.y-E.y)/2),K=Math.pow(B.x,2)/Math.pow(t,2)+Math.pow(B.y,2)/Math.pow(C,2);1<K&&(t*=Math.sqrt(K),C*=Math.sqrt(K));y=(y==z?-1:1)*Math.sqrt((Math.pow(t,2)*Math.pow(C,2)-Math.pow(t,2)*Math.pow(B.y,2)-Math.pow(C,2)*Math.pow(B.x,2))/(Math.pow(t,2)*Math.pow(B.y,2)+Math.pow(C,2)*Math.pow(B.x,2)));isNaN(y)&&(y=0);var u=new p.Point(y*t*B.y/C,y*-C*B.x/t),A=new p.Point((A.x+E.x)/2+Math.cos(D)*u.x-Math.sin(D)*u.y,(A.y+E.y)/2+Math.sin(D)*u.x+Math.cos(D)*u.y),J=function(w,v){return(w[0]*v[0]+w[1]*v[1])/(Math.sqrt(Math.pow(w[0],2)+Math.pow(w[1],2))*Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2)))},I=function(w,v){return(w[0]*v[1]<w[1]*v[0]?-1:1)*Math.acos(J(w,v))},y=I([1,0],[(B.x-u.x)/t,(B.y-u.y)/C]),K=[(B.x-u.x)/t,(B.y-u.y)/C],u=[(-B.x-u.x)/t,(-B.y-u.y)/C],B=I(K,u);-1>=J(K,u)&&(B=Math.PI);1<=J(K,u)&&(B=0);K=1-z?1:-1;u=y+B/2*K;I=new p.Point(A.x+t*Math.cos(u),A.y+C*Math.sin(u));F.addMarkerAngle(I,u-K*Math.PI/2);F.addMarkerAngle(E,u-K*Math.PI);G.addPoint(E.x,E.y);null!=H&&(J=t>C?t:C,E=t>C?1:t/C,t=t>C?C/t:1,H.translate(A.x,A.y),H.rotate(D),H.scale(E,t),H.arc(0,0,J,y,y+B,1-z),H.scale(1/E,1/t),H.rotate(-D),H.translate(-A.x,-A.y))}break;case"Z":case"z":null!=H&&H.closePath(),F.current=F.start}}return G};this.getMarkers=function(){for(var u=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),w=[],v=0;v<u.length;v++){w.push([u[v],t[v]])}return w}};p.Element.path.prototype=new p.Element.PathElementBase;p.Element.pattern=function(r){this.base=p.Element.ElementBase;this.base(r);this.createPattern=function(t,w){var x=this.attribute("width").toPixels("x",!0),y=this.attribute("height").toPixels("y",!0),v=new p.Element.svg;v.attributes.viewBox=new p.Property("viewBox",this.attribute("viewBox").value);v.attributes.width=new p.Property("width",x+"px");v.attributes.height=new p.Property("height",y+"px");v.attributes.transform=new p.Property("transform",this.attribute("patternTransform").value);v.children=this.children;var u=document.createElement("canvas");u.width=x;u.height=y;x=u.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&x.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(y=-1;1>=y;y++){for(var s=-1;1>=s;s++){x.save(),v.attributes.x=new p.Property("x",y*u.width),v.attributes.y=new p.Property("y",s*u.height),v.render(x),x.restore()}}return t.createPattern(u,"repeat")}};p.Element.pattern.prototype=new p.Element.ElementBase;p.Element.marker=function(r){this.base=p.Element.ElementBase;this.base(r);this.baseRender=this.render;this.render=function(s,t,u){s.translate(t.x,t.y);"auto"==this.attribute("orient").valueOrDefault("auto")&&s.rotate(u);"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&s.scale(s.lineWidth,s.lineWidth);s.save();var v=new p.Element.svg;v.attributes.viewBox=new p.Property("viewBox",this.attribute("viewBox").value);v.attributes.refX=new p.Property("refX",this.attribute("refX").value);v.attributes.refY=new p.Property("refY",this.attribute("refY").value);v.attributes.width=new p.Property("width",this.attribute("markerWidth").value);v.attributes.height=new p.Property("height",this.attribute("markerHeight").value);v.attributes.fill=new p.Property("fill",this.attribute("fill").valueOrDefault("black"));v.attributes.stroke=new p.Property("stroke",this.attribute("stroke").valueOrDefault("none"));v.children=this.children;v.render(s);s.restore();"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&s.scale(1/s.lineWidth,1/s.lineWidth);"auto"==this.attribute("orient").valueOrDefault("auto")&&s.rotate(-u);s.translate(-t.x,-t.y)}};p.Element.marker.prototype=new p.Element.ElementBase;p.Element.defs=function(r){this.base=p.Element.ElementBase;this.base(r);this.render=function(s){}};p.Element.defs.prototype=new p.Element.ElementBase;p.Element.GradientBase=function(s){this.base=p.Element.ElementBase;this.base(s);this.stops=[];for(s=0;s<this.children.length;s++){var r=this.children[s];"stop"==r.type&&this.stops.push(r)}this.getGradient=function(){};this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")};this.attributesToInherit=["gradientUnits"];this.inheritStopContainer=function(u){for(var t=0;t<this.attributesToInherit.length;t++){var v=this.attributesToInherit[t];!this.attribute(v).hasValue()&&u.attribute(v).hasValue()&&(this.attribute(v,!0).value=u.attribute(v).value)}};this.createGradient=function(t,w,x){var v=this;this.getHrefAttribute().hasValue()&&(v=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(v));var u=function(y){return x.hasValue()?(new p.Property("color",y)).addOpacity(x).value:y};t=this.getGradient(t,w);if(null==t){return u(v.stops[v.stops.length-1].color)}for(w=0;w<v.stops.length;w++){t.addColorStop(v.stops[w].offset,u(v.stops[w].color))}return this.attribute("gradientTransform").hasValue()?(v=p.ViewPort.viewPorts[0],u=new p.Element.rect,u.attributes.x=new p.Property("x",-p.MAX_VIRTUAL_PIXELS/3),u.attributes.y=new p.Property("y",-p.MAX_VIRTUAL_PIXELS/3),u.attributes.width=new p.Property("width",p.MAX_VIRTUAL_PIXELS),u.attributes.height=new p.Property("height",p.MAX_VIRTUAL_PIXELS),w=new p.Element.g,w.attributes.transform=new p.Property("transform",this.attribute("gradientTransform").value),w.children=[u],u=new p.Element.svg,u.attributes.x=new p.Property("x",0),u.attributes.y=new p.Property("y",0),u.attributes.width=new p.Property("width",v.width),u.attributes.height=new p.Property("height",v.height),u.children=[w],w=document.createElement("canvas"),w.width=v.width,w.height=v.height,v=w.getContext("2d"),v.fillStyle=t,u.render(v),v.createPattern(w,"no-repeat")):t}};p.Element.GradientBase.prototype=new p.Element.ElementBase;p.Element.linearGradient=function(r){this.base=p.Element.GradientBase;this.base(r);this.attributesToInherit.push("x1");this.attributesToInherit.push("y1");this.attributesToInherit.push("x2");this.attributesToInherit.push("y2");this.getGradient=function(s,w){var x="objectBoundingBox"==this.gradientUnits()?w.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var t="objectBoundingBox"==this.gradientUnits()?x.x()+x.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),v="objectBoundingBox"==this.gradientUnits()?x.y()+x.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),u="objectBoundingBox"==this.gradientUnits()?x.x()+x.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),x="objectBoundingBox"==this.gradientUnits()?x.y()+x.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return t==u&&v==x?null:s.createLinearGradient(t,v,u,x)}};p.Element.linearGradient.prototype=new p.Element.GradientBase;p.Element.radialGradient=function(r){this.base=p.Element.GradientBase;this.base(r);this.attributesToInherit.push("cx");this.attributesToInherit.push("cy");this.attributesToInherit.push("r");this.attributesToInherit.push("fx");this.attributesToInherit.push("fy");this.getGradient=function(t,y){var x=y.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%");this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%");this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var u="objectBoundingBox"==this.gradientUnits()?x.x()+x.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),w="objectBoundingBox"==this.gradientUnits()?x.y()+x.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),v=u,s=w;this.attribute("fx").hasValue()&&(v="objectBoundingBox"==this.gradientUnits()?x.x()+x.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x"));this.attribute("fy").hasValue()&&(s="objectBoundingBox"==this.gradientUnits()?x.y()+x.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));x="objectBoundingBox"==this.gradientUnits()?(x.width()+x.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(v,s,0,u,w,x)}};p.Element.radialGradient.prototype=new p.Element.GradientBase;p.Element.stop=function(r){this.base=p.Element.ElementBase;this.base(r);this.offset=this.attribute("offset").numValue();0>this.offset&&(this.offset=0);1<this.offset&&(this.offset=1);r=this.style("stop-color",!0);""===r.value&&(r.value="#000");this.style("stop-opacity").hasValue()&&(r=r.addOpacity(this.style("stop-opacity")));this.color=r.value};p.Element.stop.prototype=new p.Element.ElementBase;p.Element.AnimateBase=function(r){this.base=p.Element.ElementBase;this.base(r);p.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var s=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==s?this.parent.style(t,!0):this.parent.attribute(t,!0)};this.initialValue=null;this.initialUnits="";this.removed=!1;this.calcValue=function(){return""};this.update=function(s){null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits());if(this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value){this.duration=0}else{if("freeze"==this.attribute("fill").valueOrDefault("remove")&&!this.frozen){this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value}else{if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed){return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}}}return !1}this.duration+=s;s=!1;this.begin<this.duration&&(s=this.calcValue(),this.attribute("type").hasValue()&&(s=this.attribute("type").value+"("+s+")"),this.getProperty().value=s,s=!0);return s};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");this.values.hasValue()&&(this.values.value=this.values.value.split(";"));this.progress=function(){var s={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var v=s.progress*(this.values.value.length-1),u=Math.floor(v),t=Math.ceil(v);s.from=new p.Property("from",parseFloat(this.values.value[u]));s.to=new p.Property("to",parseFloat(this.values.value[t]));s.progress=(v-u)/(t-u)}else{s.from=this.from,s.to=this.to}return s}};p.Element.AnimateBase.prototype=new p.Element.ElementBase;p.Element.animate=function(r){this.base=p.Element.AnimateBase;this.base(r);this.calcValue=function(){var s=this.progress();return s.from.numValue()+(s.to.numValue()-s.from.numValue())*s.progress+this.initialUnits}};p.Element.animate.prototype=new p.Element.AnimateBase;p.Element.animateColor=function(r){this.base=p.Element.AnimateBase;this.base(r);this.calcValue=function(){var s=this.progress(),w=new g(s.from.value),v=new g(s.to.value);if(w.ok&&v.ok){var t=w.g+(v.g-w.g)*s.progress,u=w.b+(v.b-w.b)*s.progress;return"rgb("+parseInt(w.r+(v.r-w.r)*s.progress,10)+","+parseInt(t,10)+","+parseInt(u,10)+")"}return this.attribute("from").value}};p.Element.animateColor.prototype=new p.Element.AnimateBase;p.Element.animateTransform=function(r){this.base=p.Element.AnimateBase;this.base(r);this.calcValue=function(){for(var s=this.progress(),w=p.ToNumberArray(s.from.value),v=p.ToNumberArray(s.to.value),t="",u=0;u<w.length;u++){t+=w[u]+(v[u]-w[u])*s.progress+" "}return t}};p.Element.animateTransform.prototype=new p.Element.animate;p.Element.font=function(s){this.base=p.Element.ElementBase;this.base(s);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.isArabic=this.isRTL=!1;this.missingGlyph=this.fontFace=null;this.glyphs=[];for(s=0;s<this.children.length;s++){var r=this.children[s];"font-face"==r.type?(this.fontFace=r,r.style("font-family").hasValue()&&(p.Definitions[r.style("font-family").value]=this)):"missing-glyph"==r.type?this.missingGlyph=r:"glyph"==r.type&&(""!=r.arabicForm?(this.isArabic=this.isRTL=!0,"undefined"==typeof this.glyphs[r.unicode]&&(this.glyphs[r.unicode]=[]),this.glyphs[r.unicode][r.arabicForm]=r):this.glyphs[r.unicode]=r)}};p.Element.font.prototype=new p.Element.ElementBase;p.Element.fontface=function(r){this.base=p.Element.ElementBase;this.base(r);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};p.Element.fontface.prototype=new p.Element.ElementBase;p.Element.missingglyph=function(r){this.base=p.Element.path;this.base(r);this.horizAdvX=0};p.Element.missingglyph.prototype=new p.Element.path;p.Element.glyph=function(r){this.base=p.Element.path;this.base(r);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};p.Element.glyph.prototype=new p.Element.path;p.Element.text=function(r){this.captureTextNodes=!0;this.base=p.Element.RenderedElementBase;this.base(r);this.baseSetContext=this.setContext;this.setContext=function(s){this.baseSetContext(s);var t=this.style("dominant-baseline").toTextBaseline();null==t&&(t=this.style("alignment-baseline").toTextBaseline());null!=t&&(s.textBaseline=t)};this.getBoundingBox=function(){var s=this.attribute("x").toPixels("x"),u=this.attribute("y").toPixels("y"),t=this.parent.style("font-size").numValueOrDefault(p.Font.Parse(p.ctx.font).fontSize);return new p.BoundingBox(s,u-t,s+Math.floor(2*t/3)*this.children[0].getText().length,u)};this.renderChildren=function(s){this.x=this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x"));this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y"));this.x+=this.getAnchorDelta(s,this,0);for(var t=0;t<this.children.length;t++){this.renderChild(s,this,t)}};this.getAnchorDelta=function(t,y,x){var u=this.style("text-anchor").valueOrDefault("start");if("start"!=u){for(var w=0,v=x;v<y.children.length;v++){var s=y.children[v];if(v>x&&s.attribute("x").hasValue()){break}w+=s.measureTextRecursive(t)}return -1*("end"==u?w:w/2)}return 0};this.renderChild=function(s,v,u){var t=v.children[u];t.attribute("x").hasValue()?(t.x=t.attribute("x").toPixels("x")+v.getAnchorDelta(s,v,u),t.attribute("dx").hasValue()&&(t.x+=t.attribute("dx").toPixels("x"))):(t.attribute("dx").hasValue()&&(v.x+=t.attribute("dx").toPixels("x")),t.x=v.x);v.x=t.x+t.measureText(s);t.attribute("y").hasValue()?(t.y=t.attribute("y").toPixels("y"),t.attribute("dy").hasValue()&&(t.y+=t.attribute("dy").toPixels("y"))):(t.attribute("dy").hasValue()&&(v.y+=t.attribute("dy").toPixels("y")),t.y=v.y);v.y=t.y;t.render(s);for(u=0;u<t.children.length;u++){v.renderChild(s,t,u)}}};p.Element.text.prototype=new p.Element.RenderedElementBase;p.Element.TextElementBase=function(r){this.base=p.Element.RenderedElementBase;this.base(r);this.getGlyph=function(s,x,w){var t=x[w],v=null;if(s.isArabic){var u="isolated";(0==w||" "==x[w-1])&&w<x.length-2&&" "!=x[w+1]&&(u="terminal");0<w&&" "!=x[w-1]&&w<x.length-2&&" "!=x[w+1]&&(u="medial");0<w&&" "!=x[w-1]&&(w==x.length-1||" "==x[w+1])&&(u="initial");"undefined"!=typeof s.glyphs[t]&&(v=s.glyphs[t][u],null==v&&"glyph"==s.glyphs[t].type&&(v=s.glyphs[t]))}else{v=s.glyphs[t]}null==v&&(v=s.missingGlyph);return v};this.renderChildren=function(B){var A=this.parent.style("font-family").getDefinition();if(null!=A){var z=this.parent.style("font-size").numValueOrDefault(p.Font.Parse(p.ctx.font).fontSize),v=this.parent.style("font-style").valueOrDefault(p.Font.Parse(p.ctx.font).fontStyle),y=this.getText();A.isRTL&&(y=y.split("").reverse().join(""));for(var x=p.ToNumberArray(this.parent.attribute("dx").value),t=0;t<y.length;t++){var s=this.getGlyph(A,y,t),w=z/A.fontFace.unitsPerEm;B.translate(this.x,this.y);B.scale(w,-w);var u=B.lineWidth;B.lineWidth=B.lineWidth*A.fontFace.unitsPerEm/z;"italic"==v&&B.transform(1,0,0.4,1,0,0);s.render(B);"italic"==v&&B.transform(1,0,-0.4,1,0,0);B.lineWidth=u;B.scale(1/w,-1/w);B.translate(-this.x,-this.y);this.x+=z*(s.horizAdvX||A.horizAdvX)/A.fontFace.unitsPerEm;"undefined"==typeof x[t]||isNaN(x[t])||(this.x+=x[t])}}else{""!=B.fillStyle&&B.fillText(p.compressSpaces(this.getText()),this.x,this.y),""!=B.strokeStyle&&B.strokeText(p.compressSpaces(this.getText()),this.x,this.y)}};this.getText=function(){};this.measureTextRecursive=function(s){for(var u=this.measureText(s),t=0;t<this.children.length;t++){u+=this.children[t].measureTextRecursive(s)}return u};this.measureText=function(t){var y=this.parent.style("font-family").getDefinition();if(null!=y){t=this.parent.style("font-size").numValueOrDefault(p.Font.Parse(p.ctx.font).fontSize);var x=0,u=this.getText();y.isRTL&&(u=u.split("").reverse().join(""));for(var w=p.ToNumberArray(this.parent.attribute("dx").value),v=0;v<u.length;v++){var s=this.getGlyph(y,u,v),x=x+(s.horizAdvX||y.horizAdvX)*t/y.fontFace.unitsPerEm;"undefined"==typeof w[v]||isNaN(w[v])||(x+=w[v])}return x}y=p.compressSpaces(this.getText());if(!t.measureText){return 10*y.length}t.save();this.setContext(t);y=t.measureText(y).width;t.restore();return y}};p.Element.TextElementBase.prototype=new p.Element.RenderedElementBase;p.Element.tspan=function(r){this.captureTextNodes=!0;this.base=p.Element.TextElementBase;this.base(r);this.text=p.compressSpaces(r.value||r.text||r.textContent||"");this.getText=function(){return 0<this.children.length?"":this.text}};p.Element.tspan.prototype=new p.Element.TextElementBase;p.Element.tref=function(r){this.base=p.Element.TextElementBase;this.base(r);this.getText=function(){var s=this.getHrefAttribute().getDefinition();if(null!=s){return s.children[0].getText()}}};p.Element.tref.prototype=new p.Element.TextElementBase;p.Element.a=function(s){this.base=p.Element.TextElementBase;this.base(s);this.hasText=0<s.childNodes.length;for(var r=0;r<s.childNodes.length;r++){3!=s.childNodes[r].nodeType&&(this.hasText=!1)}this.text=this.hasText?s.childNodes[0].value:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var u=new p.Property("fontSize",p.Font.Parse(p.ctx.font).fontSize);p.Mouse.checkBoundingBox(this,new p.BoundingBox(this.x,this.y-u.toPixels("y"),this.x+this.measureText(t),this.y))}else{0<this.children.length&&(u=new p.Element.g,u.children=this.children,u.parent=this,u.render(t))}};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){p.ctx.canvas.style.cursor="pointer"}};p.Element.a.prototype=new p.Element.TextElementBase;p.Element.image=function(u){this.base=p.Element.RenderedElementBase;this.base(u);var r=this.getHrefAttribute().value;if(""!=r){var s=r.match(/\.svg$/);p.Images.push(this);this.loaded=!1;if(s){this.img=p.ajax(r),this.loaded=!0}else{this.img=document.createElement("img");1==p.opts.useCORS&&(this.img.crossOrigin="Anonymous");var t=this;this.img.onload=function(){t.loaded=!0};this.img.onerror=function(){p.log('ERROR: image "'+r+'" not found');t.loaded=!0};this.img.src=r}this.renderChildren=function(w){var z=this.attribute("x").toPixels("x"),x=this.attribute("y").toPixels("y"),v=this.attribute("width").toPixels("x"),y=this.attribute("height").toPixels("y");0!=v&&0!=y&&(w.save(),s?w.drawSvg(this.img,z,x,v,y):(w.translate(z,x),p.AspectRatio(w,this.attribute("preserveAspectRatio").value,v,this.img.width,y,this.img.height,0,0),w.drawImage(this.img,0,0)),w.restore())};this.getBoundingBox=function(){var v=this.attribute("x").toPixels("x"),y=this.attribute("y").toPixels("y"),x=this.attribute("width").toPixels("x"),w=this.attribute("height").toPixels("y");return new p.BoundingBox(v,y,v+x,y+w)}}};p.Element.image.prototype=new p.Element.RenderedElementBase;p.Element.g=function(r){this.base=p.Element.RenderedElementBase;this.base(r);this.getBoundingBox=function(){for(var s=new p.BoundingBox,t=0;t<this.children.length;t++){s.addBoundingBox(this.children[t].getBoundingBox())}return s}};p.Element.g.prototype=new p.Element.RenderedElementBase;p.Element.symbol=function(r){this.base=p.Element.RenderedElementBase;this.base(r);this.render=function(s){}};p.Element.symbol.prototype=new p.Element.RenderedElementBase;p.Element.style=function(A){this.base=p.Element.ElementBase;this.base(A);for(var B="",y=0;y<A.childNodes.length;y++){B+=A.childNodes[y].data}B=B.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");B=p.compressSpaces(B);A=B.split("}");for(y=0;y<A.length;y++){if(""!=p.trim(A[y])){for(var z=A[y].split("{"),B=z[0].split(","),z=z[1].split(";"),u=0;u<B.length;u++){var x=p.trim(B[u]);if(""!=x){for(var w=p.Styles[x]||{},s=0;s<z.length;s++){var r=z[s].indexOf(":"),v=z[s].substr(0,r),r=z[s].substr(r+1,z[s].length-r);null!=v&&null!=r&&(w[p.trim(v)]=new p.Property(p.trim(v),p.trim(r)))}p.Styles[x]=w;p.StylesSpecificity[x]=d(x);if("@font-face"==x){for(x=w["font-family"].value.replace(/"/g,""),w=w.src.value.split(","),s=0;s<w.length;s++){if(0<w[s].indexOf('format("svg")')){for(v=w[s].indexOf("url"),r=w[s].indexOf(")",v),v=w[s].substr(v+5,r-v-6),v=p.parseXml(p.ajax(v)).getElementsByTagName("font"),r=0;r<v.length;r++){var t=p.CreateElement(v[r]);p.Definitions[x]=t}}}}}}}}};p.Element.style.prototype=new p.Element.ElementBase;p.Element.use=function(s){this.base=p.Element.RenderedElementBase;this.base(s);this.baseSetContext=this.setContext;this.setContext=function(t){this.baseSetContext(t);this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0);this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var r=this.getHrefAttribute().getDefinition();this.path=function(t){null!=r&&r.path(t)};this.getBoundingBox=function(){if(null!=r){return r.getBoundingBox()}};this.renderChildren=function(v){if(null!=r){var u=r;"symbol"==r.type&&(u=new p.Element.svg,u.type="svg",u.attributes.viewBox=new p.Property("viewBox",r.attribute("viewBox").value),u.attributes.preserveAspectRatio=new p.Property("preserveAspectRatio",r.attribute("preserveAspectRatio").value),u.attributes.overflow=new p.Property("overflow",r.attribute("overflow").value),u.children=r.children);"svg"==u.type&&(this.attribute("width").hasValue()&&(u.attributes.width=new p.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(u.attributes.height=new p.Property("height",this.attribute("height").value)));var t=u.parent;u.parent=null;u.render(v);u.parent=t}}};p.Element.use.prototype=new p.Element.RenderedElementBase;p.Element.mask=function(r){this.base=p.Element.ElementBase;this.base(r);this.apply=function(C,B){var A=this.attribute("x").toPixels("x"),w=this.attribute("y").toPixels("y"),z=this.attribute("width").toPixels("x"),y=this.attribute("height").toPixels("y");if(0==z&&0==y){y=new p.BoundingBox;for(A=0;A<this.children.length;A++){y.addBoundingBox(this.children[A].getBoundingBox())}A=Math.floor(y.x1);w=Math.floor(y.y1);z=Math.floor(y.width());y=Math.floor(y.height())}var u=B.attribute("mask").value;B.attribute("mask").value="";var t=document.createElement("canvas");t.width=A+z;t.height=w+y;var x=t.getContext("2d");this.renderChildren(x);var v=document.createElement("canvas");v.width=A+z;v.height=w+y;var s=v.getContext("2d");B.render(s);s.globalCompositeOperation="destination-in";s.fillStyle=x.createPattern(t,"no-repeat");s.fillRect(0,0,A+z,w+y);C.fillStyle=s.createPattern(v,"no-repeat");C.fillRect(0,0,A+z,w+y);B.attribute("mask").value=u};this.render=function(s){}};p.Element.mask.prototype=new p.Element.ElementBase;p.Element.clipPath=function(r){this.base=p.Element.ElementBase;this.base(r);this.apply=function(s){var x=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var w=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){};x.call(s);for(var t=0;t<this.children.length;t++){var v=this.children[t];if("undefined"!=typeof v.path){var u=null;v.style("transform",!1,!0).hasValue()&&(u=new p.Transform(v.style("transform",!1,!0).value),u.apply(s));v.path(s);CanvasRenderingContext2D.prototype.closePath=w;u&&u.unapply(s)}}w.call(s);s.clip();CanvasRenderingContext2D.prototype.beginPath=x;CanvasRenderingContext2D.prototype.closePath=w};this.render=function(s){}};p.Element.clipPath.prototype=new p.Element.ElementBase;p.Element.filter=function(r){this.base=p.Element.ElementBase;this.base(r);this.apply=function(D,C){var B=C.getBoundingBox(),x=Math.floor(B.x1),A=Math.floor(B.y1),z=Math.floor(B.width()),B=Math.floor(B.height()),v=C.style("filter").value;C.style("filter").value="";for(var y=0,w=0,E=0;E<this.children.length;E++){var s=this.children[E].extraFilterDistance||0,y=Math.max(y,s),w=Math.max(w,s)}s=document.createElement("canvas");s.width=z+2*y;s.height=B+2*w;var F=s.getContext("2d");F.translate(-x+y,-A+w);C.render(F);for(E=0;E<this.children.length;E++){"function"===typeof this.children[E].apply&&this.children[E].apply(F,0,0,z+2*y,B+2*w)}D.drawImage(s,0,0,z+2*y,B+2*w,x-y,A-w,z+2*y,B+2*w);C.style("filter",!0).value=v};this.render=function(s){}};p.Element.filter.prototype=new p.Element.ElementBase;p.Element.feMorphology=function(r){this.base=p.Element.ElementBase;this.base(r);this.apply=function(s,w,v,t,u){}};p.Element.feMorphology.prototype=new p.Element.ElementBase;p.Element.feComposite=function(r){this.base=p.Element.ElementBase;this.base(r);this.apply=function(s,w,v,t,u){}};p.Element.feComposite.prototype=new p.Element.ElementBase;p.Element.feColorMatrix=function(u){function r(w,v){var x=s[w];return x*(0>x?v-255:v)}this.base=p.Element.ElementBase;this.base(u);var s=p.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":u=s[0];s=[0.213+0.787*u,0.715-0.715*u,0.072-0.072*u,0,0,0.213-0.213*u,0.715+0.285*u,0.072-0.072*u,0,0,0.213-0.213*u,0.715-0.715*u,0.072+0.928*u,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var t=s[0]*Math.PI/180;u=function(w,v,x){return w+Math.cos(t)*v+Math.sin(t)*x};s=[u(0.213,0.787,-0.213),u(0.715,-0.715,-0.715),u(0.072,-0.072,0.928),0,0,u(0.213,-0.213,0.143),u(0.715,0.285,0.14),u(0.072,-0.072,-0.283),0,0,u(0.213,-0.213,-0.787),u(0.715,-0.715,0.715),u(0.072,0.928,0.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0,1]}this.apply=function(D,C,B,A,z){var y=D.getImageData(0,0,A,z);for(B=0;B<z;B++){for(C=0;C<A;C++){var F=y.data[B*A*4+4*C+0],x=y.data[B*A*4+4*C+1],G=y.data[B*A*4+4*C+2],E=y.data[B*A*4+4*C+3],w=r(0,F)+r(1,x)+r(2,G)+r(3,E)+r(4,1);y.data[B*A*4+4*C+0]=w;w=r(5,F)+r(6,x)+r(7,G)+r(8,E)+r(9,1);y.data[B*A*4+4*C+1]=w;w=r(10,F)+r(11,x)+r(12,G)+r(13,E)+r(14,1);y.data[B*A*4+4*C+2]=w;F=r(15,F)+r(16,x)+r(17,G)+r(18,E)+r(19,1);y.data[B*A*4+4*C+3]=F}}D.clearRect(0,0,A,z);D.putImageData(y,0,0)}};p.Element.feColorMatrix.prototype=new p.Element.ElementBase;p.Element.feGaussianBlur=function(r){this.base=p.Element.ElementBase;this.base(r);this.extraFilterDistance=this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());this.apply=function(s,w,v,t,u){"undefined"==typeof f.canvasRGBA?p.log("ERROR: StackBlur.js must be included for blur to work"):(s.canvas.id=p.UniqueId(),s.canvas.style.display="none",document.body.appendChild(s.canvas),f.canvasRGBA(s.canvas.id,w,v,t,u,this.blurRadius),document.body.removeChild(s.canvas))}};p.Element.feGaussianBlur.prototype=new p.Element.ElementBase;p.Element.title=function(r){};p.Element.title.prototype=new p.Element.ElementBase;p.Element.desc=function(r){};p.Element.desc.prototype=new p.Element.ElementBase;p.Element.MISSING=function(r){p.log("ERROR: Element '"+r.nodeName+"' not yet implemented.")};p.Element.MISSING.prototype=new p.Element.ElementBase;p.CreateElement=function(s){var r=s.nodeName.replace(/^[^:]+:/,""),r=r.replace(/\-/g,""),r="undefined"!=typeof p.Element[r]?new p.Element[r](s):new p.Element.MISSING(s);r.type=s.nodeName;return r};p.load=function(s,r){p.loadXml(s,p.ajax(r))};p.loadXml=function(s,r){p.loadXmlDoc(s,p.parseXml(r))};p.loadXmlDoc=function(x,r){p.init(x);var v=function(z){for(var y=x.canvas;y;){z.x-=y.offsetLeft,z.y-=y.offsetTop,y=y.offsetParent}window.scrollX&&(z.x+=window.scrollX);window.scrollY&&(z.y+=window.scrollY);return z};1!=p.opts.ignoreMouse&&(x.canvas.onclick=function(y){y=v(new p.Point(null!=y?y.clientX:event.clientX,null!=y?y.clientY:event.clientY));p.Mouse.onclick(y.x,y.y)},x.canvas.onmousemove=function(y){y=v(new p.Point(null!=y?y.clientX:event.clientX,null!=y?y.clientY:event.clientY));p.Mouse.onmousemove(y.x,y.y)});var w=p.CreateElement(r.documentElement);w.root=!0;w.addStylesFromStyleDefinition();var s=!0,u=function(){p.ViewPort.Clear();x.canvas.parentNode&&p.ViewPort.SetCurrent(x.canvas.parentNode.clientWidth,x.canvas.parentNode.clientHeight);1!=p.opts.ignoreDimensions&&(w.style("width").hasValue()&&(x.canvas.width=w.style("width").toPixels("x"),x.canvas.style.width=x.canvas.width+"px"),w.style("height").hasValue()&&(x.canvas.height=w.style("height").toPixels("y"),x.canvas.style.height=x.canvas.height+"px"));var C=x.canvas.clientWidth||x.canvas.width,B=x.canvas.clientHeight||x.canvas.height;1==p.opts.ignoreDimensions&&w.style("width").hasValue()&&w.style("height").hasValue()&&(C=w.style("width").toPixels("x"),B=w.style("height").toPixels("y"));p.ViewPort.SetCurrent(C,B);null!=p.opts.offsetX&&(w.attribute("x",!0).value=p.opts.offsetX);null!=p.opts.offsetY&&(w.attribute("y",!0).value=p.opts.offsetY);if(null!=p.opts.scaleWidth||null!=p.opts.scaleHeight){var A=null,z=null,y=p.ToNumberArray(w.attribute("viewBox").value);null!=p.opts.scaleWidth&&(w.attribute("width").hasValue()?A=w.attribute("width").toPixels("x")/p.opts.scaleWidth:isNaN(y[2])||(A=y[2]/p.opts.scaleWidth));null!=p.opts.scaleHeight&&(w.attribute("height").hasValue()?z=w.attribute("height").toPixels("y")/p.opts.scaleHeight:isNaN(y[3])||(z=y[3]/p.opts.scaleHeight));null==A&&(A=z);null==z&&(z=A);w.attribute("width",!0).value=p.opts.scaleWidth;w.attribute("height",!0).value=p.opts.scaleHeight;w.style("transform",!0,!0).value+=" scale("+1/A+","+1/z+")"}1!=p.opts.ignoreClear&&x.clearRect(0,0,C,B);w.render(x);s&&(s=!1,"function"==typeof p.opts.renderCallback&&p.opts.renderCallback(r))},t=!0;p.ImagesLoaded()&&(t=!1,u());p.intervalID=setInterval(function(){var y=!1;t&&p.ImagesLoaded()&&(t=!1,y=!0);1!=p.opts.ignoreMouse&&(y|=p.Mouse.hasEvents());if(1!=p.opts.ignoreAnimation){for(var z=0;z<p.Animations.length;z++){y|=p.Animations[z].update(1000/p.FRAMERATE)}}"function"==typeof p.opts.forceRedraw&&1==p.opts.forceRedraw()&&(y=!0);y&&(u(),p.Mouse.runEvents())},1000/p.FRAMERATE)};p.stop=function(){p.intervalID&&clearInterval(p.intervalID)};p.Mouse=new function(){this.events=[];this.hasEvents=function(){return 0!=this.events.length};this.onclick=function(s,r){this.events.push({type:"onclick",x:s,y:r,run:function(t){if(t.onclick){t.onclick()}}})};this.onmousemove=function(s,r){this.events.push({type:"onmousemove",x:s,y:r,run:function(t){if(t.onmousemove){t.onmousemove()}}})};this.eventElements=[];this.checkPath=function(s,r){for(var t=0;t<this.events.length;t++){var u=this.events[t];r.isPointInPath&&r.isPointInPath(u.x,u.y)&&(this.eventElements[t]=s)}};this.checkBoundingBox=function(s,r){for(var t=0;t<this.events.length;t++){var u=this.events[t];r.isPointInBox(u.x,u.y)&&(this.eventElements[t]=s)}};this.runEvents=function(){p.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++){for(var r=this.events[t],s=this.eventElements[t];s;){r.run(s),s=s.parent}}this.events=[];this.eventElements=[]}};return p}var e=function(r,q,p){if(null==r&&null==q&&null==p){for(q=document.querySelectorAll("svg"),r=0;r<q.length;r++){p=q[r];var s=document.createElement("canvas");s.width=p.clientWidth;s.height=p.clientHeight;p.parentNode.insertBefore(s,p);p.parentNode.removeChild(p);var o=document.createElement("div");o.appendChild(p);e(s,o.innerHTML)}}else{"string"==typeof r&&(r=document.getElementById(r));null!=r.svg&&r.svg.stop();p=h(p||{});if(1!=r.childNodes.length||"OBJECT"!=r.childNodes[0].nodeName){r.svg=p}r=r.getContext("2d");"undefined"!=typeof q.documentElement?p.loadXmlDoc(r,q):"<"==q.substr(0,1)?p.loadXml(r,q):p.load(r,q)}},j;if("undefined"!=typeof Element.prototype.matches){j=function(p,o){return p.matches(o)}}else{if("undefined"!=typeof Element.prototype.webkitMatchesSelector){j=function(p,o){return p.webkitMatchesSelector(o)}}else{if("undefined"!=typeof Element.prototype.mozMatchesSelector){j=function(p,o){return p.mozMatchesSelector(o)}}else{if("undefined"!=typeof Element.prototype.msMatchesSelector){j=function(p,o){return p.msMatchesSelector(o)}}else{if("undefined"!=typeof Element.prototype.oMatchesSelector){j=function(p,o){return p.oMatchesSelector(o)}}else{if("function"===typeof jQuery||"function"===typeof Zepto){j=function(p,o){return $(p).is(o)}}"undefined"===typeof j&&(j=Sizzle.matchesSelector)}}}}}var c=/(\[[^\]]+\])/g,b=/(#[^\s\+>~\.\[:]+)/g,a=/(\.[^\s\+>~\.\[:]+)/g,n=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,m=/(:[\w-]+\([^\)]*\))/gi,l=/(:[^\s\+>~\.\[:]+)/g,k=/([^\s\+>~\.\[:]+)/g;"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(r,q,p,s,o){e(this.canvas,r,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:q,offsetY:p,scaleWidth:s,scaleHeight:o})});return e});